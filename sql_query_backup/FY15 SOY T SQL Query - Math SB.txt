-- These queries set up data for start-of-year student performance data reporting.

-- Step 1.1 and 1.2: Restructure all math standards based data (tagged), keeping only scale_local variables. Need one version for pre-tags and one for post-tags.
-- Step 2: First, merge scale_local variables to original table dbo_EVAL_SB_MATH.
-- Step 3: Then, use scale_local variables available for creating new variables at this current step.
-- Step 4: Final calculation of additional variables, based on variables created in Step 3.

-- (Step 1.1) QUERY SYNTAX (Restructure data file - pre-tagged data):

SELECT MTH_SB.STUDENT_ID,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'PRE' AND MTH_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;

-- (Step 1.2) QUERY SYNTAX (Restructure data file - post-tagged data):

SELECT MTH_SB.STUDENT_ID,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'POST' AND MTH_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;

-- (Step 2) QUERY SYNTAX (Join the scale_local variables with the original table dbo_ELA_SB_MATH):

SELECT MTH_SB_Orig.STUDENT_ID, MTH_SB_Orig.PRE_INTERVAL, MTH_SB_Orig.PRE_ART_POL_RAT_EXP, MTH_SB_Orig.PRE_CRE_EQU, MTH_SB_Orig.PRE_DEMO_MAS_BAS_FACT, MTH_SB_Orig.PRE_EXP_EQU, MTH_SB_Orig.PRE_FUNCTIONS, MTH_SB_Orig.PRE_GEOMET, MTH_SB_Orig.PRE_GEOMET_MEASURE, MTH_SB_Orig.PRE_MATH_PRACTICE, MTH_SB_Orig.PRE_MEASURE_DATA, MTH_SB_Orig.PRE_NUM_OPER_FRACTIONS, MTH_SB_Orig.PRE_NUM_OPER_BASETEN, MTH_SB_Orig.PRE_OPER_ALG_THINK, MTH_SB_Orig.PRE_RATIO_PRO_REL, MTH_SB_Orig.PRE_REA_EQU_INEQU, MTH_SB_Orig.PRE_SEE_STRUCT_EXP, MTH_SB_Orig.PRE_STAT_PROB, MTH_SB_Orig.PRE_NUM_SYS, MTH_SB_Orig.POST_INTERVAL, MTH_SB_Orig.POST_ART_POL_RAT_EXP, MTH_SB_Orig.POST_CRE_EQU, MTH_SB_Orig.POST_DEMO_MAS_BAS_FACT, MTH_SB_Orig.POST_EXP_EQU, MTH_SB_Orig.POST_FUNCTIONS, MTH_SB_Orig.POST_GEOMET, MTH_SB_Orig.POST_GEOMET_MEASURE, MTH_SB_Orig.POST_MATH_PRACTICE, MTH_SB_Orig.POST_MEASURE_DATA, MTH_SB_Orig.POST_NUM_OPER_FRACTIONS, MTH_SB_Orig.POST_NUM_OPER_BASETEN, MTH_SB_Orig.POST_OPER_ALG_THINK, MTH_SB_Orig.POST_RATIO_PRO_REL, MTH_SB_Orig.POST_REA_EQU_INEQU, MTH_SB_Orig.POST_SEE_STRUCT_EXP, MTH_SB_Orig.POST_STAT_PROB, MTH_SB_Orig.POST_NUM_SYS, MTH_SB_Orig.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.CURRENTLY_ENROLLED, MTH_SB_Orig.ENROLLED_DAYS, MTH_SB_Orig.ENROLLED_DAYS_CATEGORIES, MTH_SB_Orig.TTL_TIME, MTH_SB_Orig.DOSAGE_CATEGORIES, MTH_SB_Orig.STATUS_SITE_DOSAGE_GOAL, MTH_SB_Orig.SITE_DOSAGE_GOAL, MTH_SB_Orig.Attendance_IA, MTH_SB_Orig.ELA_IA, MTH_SB_Orig.Math_IA, MTH_SB_Orig.Behavior_IA, MTH_SB_Orig.FISCAL_YEAR, MTH_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, MTH_PRE_LVL.PRE_ART_POL_RAT_EXP_LVL, MTH_PRE_LVL.PRE_CRE_EQU_LVL, MTH_PRE_LVL.PRE_DEMO_MAS_BAS_FACT_LVL, MTH_PRE_LVL.PRE_EXP_EQU_LVL, MTH_PRE_LVL.PRE_FUNCTIONS_LVL, MTH_PRE_LVL.PRE_GEOMET_LVL, MTH_PRE_LVL.PRE_GEOMET_MEASURE_LVL, MTH_PRE_LVL.PRE_MATH_PRACTICE_LVL, MTH_PRE_LVL.PRE_MEASURE_DATA_LVL, MTH_PRE_LVL.PRE_NUM_OPER_FRACTIONS_LVL, MTH_PRE_LVL.PRE_NUM_OPER_BASETEN_LVL, MTH_PRE_LVL.PRE_OPER_ALG_THINK_LVL, MTH_PRE_LVL.PRE_RATIO_PRO_REL_LVL, MTH_PRE_LVL.PRE_REA_EQU_INEQU_LVL, MTH_PRE_LVL.PRE_SEE_STRUCT_EXP_LVL, MTH_PRE_LVL.PRE_STAT_PROB_LVL, MTH_PRE_LVL.PRE_NUM_SYS_LVL, MTH_POST_LVL.POST_FREQUENCY_PERIOD_ID, MTH_POST_LVL.POST_ART_POL_RAT_EXP_LVL, MTH_POST_LVL.POST_CRE_EQU_LVL, MTH_POST_LVL.POST_DEMO_MAS_BAS_FACT_LVL, MTH_POST_LVL.POST_EXP_EQU_LVL, MTH_POST_LVL.POST_FUNCTIONS_LVL, MTH_POST_LVL.POST_GEOMET_LVL, MTH_POST_LVL.POST_GEOMET_MEASURE_LVL, MTH_POST_LVL.POST_MATH_PRACTICE_LVL, MTH_POST_LVL.POST_MEASURE_DATA_LVL, MTH_POST_LVL.POST_NUM_OPER_FRACTIONS_LVL, MTH_POST_LVL.POST_NUM_OPER_BASETEN_LVL, MTH_POST_LVL.POST_OPER_ALG_THINK_LVL, MTH_POST_LVL.POST_RATIO_PRO_REL_LVL, MTH_POST_LVL.POST_REA_EQU_INEQU_LVL, MTH_POST_LVL.POST_SEE_STRUCT_EXP_LVL, MTH_POST_LVL.POST_STAT_PROB_LVL, MTH_POST_LVL.POST_NUM_SYS_LVL
FROM (ReportCYData.dbo.EVAL_SB_MATH AS MTH_SB_Orig
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.1 PRE)*****)
AS MTH_PRE_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_PRE_LVL.STUDENT_ID))
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.2 POST)*****)
AS MTH_POST_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_POST_LVL.STUDENT_ID)
WHERE MTH_SB_Orig.FISCAL_YEAR LIKE '2014-2015';

-- (Step 3) QUERY SYNTAX (Merge and concatenate -- BASED ON ABOVE QUERIES):

SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_ART_POL_RAT_EXP, prepost.PRE_CRE_EQU, prepost.PRE_DEMO_MAS_BAS_FACT, prepost.PRE_EXP_EQU, prepost.PRE_FUNCTIONS, prepost.PRE_GEOMET, prepost.PRE_GEOMET_MEASURE, prepost.PRE_MATH_PRACTICE, prepost.PRE_MEASURE_DATA, prepost.PRE_NUM_OPER_FRACTIONS, prepost.PRE_NUM_OPER_BASETEN, prepost.PRE_OPER_ALG_THINK, prepost.PRE_RATIO_PRO_REL, prepost.PRE_REA_EQU_INEQU, prepost.PRE_SEE_STRUCT_EXP, prepost.PRE_STAT_PROB, prepost.PRE_NUM_SYS, prepost.POST_INTERVAL, prepost.POST_ART_POL_RAT_EXP, prepost.POST_CRE_EQU, prepost.POST_DEMO_MAS_BAS_FACT, prepost.POST_EXP_EQU, prepost.POST_FUNCTIONS, prepost.POST_GEOMET, prepost.POST_GEOMET_MEASURE, prepost.POST_MATH_PRACTICE, prepost.POST_MEASURE_DATA, prepost.POST_NUM_OPER_FRACTIONS, prepost.POST_NUM_OPER_BASETEN, prepost.POST_OPER_ALG_THINK, prepost.POST_RATIO_PRO_REL, prepost.POST_REA_EQU_INEQU, prepost.POST_SEE_STRUCT_EXP, prepost.POST_STAT_PROB, prepost.POST_NUM_SYS, prepost.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, prepost.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, prepost.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, prepost.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_CRE_EQU_GRADE_CHANGE_DEGREE, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, prepost.SB_EXP_EQU_GRADE_CHANGE_DEGREE, prepost.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, prepost.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_STAT_PROB_GRADE_CHANGE_DEGREE, prepost.SB_NUM_SYS_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_ART_POL_RAT_EXP_LVL, prepost.PRE_CRE_EQU_LVL, prepost.PRE_DEMO_MAS_BAS_FACT_LVL, prepost.PRE_EXP_EQU_LVL, prepost.PRE_FUNCTIONS_LVL, prepost.PRE_GEOMET_LVL, prepost.PRE_GEOMET_MEASURE_LVL, prepost.PRE_MATH_PRACTICE_LVL, prepost.PRE_MEASURE_DATA_LVL, prepost.PRE_NUM_OPER_FRACTIONS_LVL, prepost.PRE_NUM_OPER_BASETEN_LVL, prepost.PRE_OPER_ALG_THINK_LVL, prepost.PRE_RATIO_PRO_REL_LVL, prepost.PRE_REA_EQU_INEQU_LVL, prepost.PRE_SEE_STRUCT_EXP_LVL, prepost.PRE_STAT_PROB_LVL, prepost.PRE_NUM_SYS_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_ART_POL_RAT_EXP_LVL, prepost.POST_CRE_EQU_LVL, prepost.POST_DEMO_MAS_BAS_FACT_LVL, prepost.POST_EXP_EQU_LVL, prepost.POST_FUNCTIONS_LVL, prepost.POST_GEOMET_LVL, prepost.POST_GEOMET_MEASURE_LVL, prepost.POST_MATH_PRACTICE_LVL, prepost.POST_MEASURE_DATA_LVL, prepost.POST_NUM_OPER_FRACTIONS_LVL, prepost.POST_NUM_OPER_BASETEN_LVL, prepost.POST_OPER_ALG_THINK_LVL, prepost.POST_RATIO_PRO_REL_LVL, prepost.POST_REA_EQU_INEQU_LVL, prepost.POST_SEE_STRUCT_EXP_LVL, prepost.POST_STAT_PROB_LVL, prepost.POST_NUM_SYS_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(*****ABOVE QUERY*****)
AS prepost ON (ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID))
ON (ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 5)
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015';

-- (Step 4) QUERY SYNTAX (Final calculation of additional variables, based on variables created in Step 4 -- BASED ON ABOVE QUERY):

DROP TABLE ImpactAnalytics.dbo.FY15_SOY_MTH_SB
SELECT MTHSBFINAL.*,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND POST_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + POST_ART_POL_RAT_EXP_LVL ELSE NULL END AS EOY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND POST_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + POST_CRE_EQU_LVL ELSE NULL END AS EOY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND POST_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + POST_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS EOY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND POST_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + POST_EXP_EQU_LVL ELSE NULL END AS EOY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND POST_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + POST_FUNCTIONS_LVL ELSE NULL END AS EOY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND POST_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + POST_GEOMET_LVL ELSE NULL END AS EOY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND POST_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + POST_GEOMET_MEASURE_LVL ELSE NULL END AS EOY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND POST_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + POST_MATH_PRACTICE_LVL ELSE NULL END AS EOY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND POST_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + POST_MEASURE_DATA_LVL ELSE NULL END AS EOY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND POST_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + POST_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS EOY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND POST_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + POST_NUM_OPER_BASETEN_LVL ELSE NULL END AS EOY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND POST_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + POST_OPER_ALG_THINK_LVL ELSE NULL END AS EOY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND POST_RATIO_PRO_REL_LVL IS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + POST_RATIO_PRO_REL_LVL ELSE NULL END AS EOY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND POST_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + POST_REA_EQU_INEQU_LVL ELSE NULL END AS EOY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND POST_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + POST_SEE_STRUCT_EXP_LVL ELSE NULL END AS EOY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND POST_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + POST_STAT_PROB_LVL ELSE NULL END AS EOY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND POST_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + POST_NUM_SYS_LVL ELSE NULL END AS EOY_NUM_SYS_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_SOY_MTH_SB
FROM
(*****ABOVE_QUERY*****)
AS MTHSBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;

-- QUERY SYNTAX (Merge and concatenate -- SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY15_SOY_MTH_SB
SELECT MTHSBFINAL.*,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND POST_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + POST_ART_POL_RAT_EXP_LVL ELSE NULL END AS EOY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND POST_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + POST_CRE_EQU_LVL ELSE NULL END AS EOY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND POST_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + POST_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS EOY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND POST_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + POST_EXP_EQU_LVL ELSE NULL END AS EOY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND POST_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + POST_FUNCTIONS_LVL ELSE NULL END AS EOY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND POST_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + POST_GEOMET_LVL ELSE NULL END AS EOY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND POST_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + POST_GEOMET_MEASURE_LVL ELSE NULL END AS EOY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND POST_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + POST_MATH_PRACTICE_LVL ELSE NULL END AS EOY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND POST_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + POST_MEASURE_DATA_LVL ELSE NULL END AS EOY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND POST_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + POST_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS EOY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND POST_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + POST_NUM_OPER_BASETEN_LVL ELSE NULL END AS EOY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND POST_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + POST_OPER_ALG_THINK_LVL ELSE NULL END AS EOY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND POST_RATIO_PRO_REL_LVL IS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + POST_RATIO_PRO_REL_LVL ELSE NULL END AS EOY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND POST_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + POST_REA_EQU_INEQU_LVL ELSE NULL END AS EOY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND POST_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + POST_SEE_STRUCT_EXP_LVL ELSE NULL END AS EOY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND POST_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + POST_STAT_PROB_LVL ELSE NULL END AS EOY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND POST_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + POST_NUM_SYS_LVL ELSE NULL END AS EOY_NUM_SYS_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_SOY_MTH_SB
FROM
(SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_ART_POL_RAT_EXP, prepost.PRE_CRE_EQU, prepost.PRE_DEMO_MAS_BAS_FACT, prepost.PRE_EXP_EQU, prepost.PRE_FUNCTIONS, prepost.PRE_GEOMET, prepost.PRE_GEOMET_MEASURE, prepost.PRE_MATH_PRACTICE, prepost.PRE_MEASURE_DATA, prepost.PRE_NUM_OPER_FRACTIONS, prepost.PRE_NUM_OPER_BASETEN, prepost.PRE_OPER_ALG_THINK, prepost.PRE_RATIO_PRO_REL, prepost.PRE_REA_EQU_INEQU, prepost.PRE_SEE_STRUCT_EXP, prepost.PRE_STAT_PROB, prepost.PRE_NUM_SYS, prepost.POST_INTERVAL, prepost.POST_ART_POL_RAT_EXP, prepost.POST_CRE_EQU, prepost.POST_DEMO_MAS_BAS_FACT, prepost.POST_EXP_EQU, prepost.POST_FUNCTIONS, prepost.POST_GEOMET, prepost.POST_GEOMET_MEASURE, prepost.POST_MATH_PRACTICE, prepost.POST_MEASURE_DATA, prepost.POST_NUM_OPER_FRACTIONS, prepost.POST_NUM_OPER_BASETEN, prepost.POST_OPER_ALG_THINK, prepost.POST_RATIO_PRO_REL, prepost.POST_REA_EQU_INEQU, prepost.POST_SEE_STRUCT_EXP, prepost.POST_STAT_PROB, prepost.POST_NUM_SYS, prepost.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, prepost.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, prepost.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, prepost.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_CRE_EQU_GRADE_CHANGE_DEGREE, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, prepost.SB_EXP_EQU_GRADE_CHANGE_DEGREE, prepost.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, prepost.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_STAT_PROB_GRADE_CHANGE_DEGREE, prepost.SB_NUM_SYS_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_ART_POL_RAT_EXP_LVL, prepost.PRE_CRE_EQU_LVL, prepost.PRE_DEMO_MAS_BAS_FACT_LVL, prepost.PRE_EXP_EQU_LVL, prepost.PRE_FUNCTIONS_LVL, prepost.PRE_GEOMET_LVL, prepost.PRE_GEOMET_MEASURE_LVL, prepost.PRE_MATH_PRACTICE_LVL, prepost.PRE_MEASURE_DATA_LVL, prepost.PRE_NUM_OPER_FRACTIONS_LVL, prepost.PRE_NUM_OPER_BASETEN_LVL, prepost.PRE_OPER_ALG_THINK_LVL, prepost.PRE_RATIO_PRO_REL_LVL, prepost.PRE_REA_EQU_INEQU_LVL, prepost.PRE_SEE_STRUCT_EXP_LVL, prepost.PRE_STAT_PROB_LVL, prepost.PRE_NUM_SYS_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_ART_POL_RAT_EXP_LVL, prepost.POST_CRE_EQU_LVL, prepost.POST_DEMO_MAS_BAS_FACT_LVL, prepost.POST_EXP_EQU_LVL, prepost.POST_FUNCTIONS_LVL, prepost.POST_GEOMET_LVL, prepost.POST_GEOMET_MEASURE_LVL, prepost.POST_MATH_PRACTICE_LVL, prepost.POST_MEASURE_DATA_LVL, prepost.POST_NUM_OPER_FRACTIONS_LVL, prepost.POST_NUM_OPER_BASETEN_LVL, prepost.POST_OPER_ALG_THINK_LVL, prepost.POST_RATIO_PRO_REL_LVL, prepost.POST_REA_EQU_INEQU_LVL, prepost.POST_SEE_STRUCT_EXP_LVL, prepost.POST_STAT_PROB_LVL, prepost.POST_NUM_SYS_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(SELECT MTH_SB_Orig.STUDENT_ID, MTH_SB_Orig.PRE_INTERVAL, MTH_SB_Orig.PRE_ART_POL_RAT_EXP, MTH_SB_Orig.PRE_CRE_EQU, MTH_SB_Orig.PRE_DEMO_MAS_BAS_FACT, MTH_SB_Orig.PRE_EXP_EQU, MTH_SB_Orig.PRE_FUNCTIONS, MTH_SB_Orig.PRE_GEOMET, MTH_SB_Orig.PRE_GEOMET_MEASURE, MTH_SB_Orig.PRE_MATH_PRACTICE, MTH_SB_Orig.PRE_MEASURE_DATA, MTH_SB_Orig.PRE_NUM_OPER_FRACTIONS, MTH_SB_Orig.PRE_NUM_OPER_BASETEN, MTH_SB_Orig.PRE_OPER_ALG_THINK, MTH_SB_Orig.PRE_RATIO_PRO_REL, MTH_SB_Orig.PRE_REA_EQU_INEQU, MTH_SB_Orig.PRE_SEE_STRUCT_EXP, MTH_SB_Orig.PRE_STAT_PROB, MTH_SB_Orig.PRE_NUM_SYS, MTH_SB_Orig.POST_INTERVAL, MTH_SB_Orig.POST_ART_POL_RAT_EXP, MTH_SB_Orig.POST_CRE_EQU, MTH_SB_Orig.POST_DEMO_MAS_BAS_FACT, MTH_SB_Orig.POST_EXP_EQU, MTH_SB_Orig.POST_FUNCTIONS, MTH_SB_Orig.POST_GEOMET, MTH_SB_Orig.POST_GEOMET_MEASURE, MTH_SB_Orig.POST_MATH_PRACTICE, MTH_SB_Orig.POST_MEASURE_DATA, MTH_SB_Orig.POST_NUM_OPER_FRACTIONS, MTH_SB_Orig.POST_NUM_OPER_BASETEN, MTH_SB_Orig.POST_OPER_ALG_THINK, MTH_SB_Orig.POST_RATIO_PRO_REL, MTH_SB_Orig.POST_REA_EQU_INEQU, MTH_SB_Orig.POST_SEE_STRUCT_EXP, MTH_SB_Orig.POST_STAT_PROB, MTH_SB_Orig.POST_NUM_SYS, MTH_SB_Orig.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.CURRENTLY_ENROLLED, MTH_SB_Orig.ENROLLED_DAYS, MTH_SB_Orig.ENROLLED_DAYS_CATEGORIES, MTH_SB_Orig.TTL_TIME, MTH_SB_Orig.DOSAGE_CATEGORIES, MTH_SB_Orig.STATUS_SITE_DOSAGE_GOAL, MTH_SB_Orig.SITE_DOSAGE_GOAL, MTH_SB_Orig.Attendance_IA, MTH_SB_Orig.ELA_IA, MTH_SB_Orig.Math_IA, MTH_SB_Orig.Behavior_IA, MTH_SB_Orig.FISCAL_YEAR, MTH_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, MTH_PRE_LVL.PRE_ART_POL_RAT_EXP_LVL, MTH_PRE_LVL.PRE_CRE_EQU_LVL, MTH_PRE_LVL.PRE_DEMO_MAS_BAS_FACT_LVL, MTH_PRE_LVL.PRE_EXP_EQU_LVL, MTH_PRE_LVL.PRE_FUNCTIONS_LVL, MTH_PRE_LVL.PRE_GEOMET_LVL, MTH_PRE_LVL.PRE_GEOMET_MEASURE_LVL, MTH_PRE_LVL.PRE_MATH_PRACTICE_LVL, MTH_PRE_LVL.PRE_MEASURE_DATA_LVL, MTH_PRE_LVL.PRE_NUM_OPER_FRACTIONS_LVL, MTH_PRE_LVL.PRE_NUM_OPER_BASETEN_LVL, MTH_PRE_LVL.PRE_OPER_ALG_THINK_LVL, MTH_PRE_LVL.PRE_RATIO_PRO_REL_LVL, MTH_PRE_LVL.PRE_REA_EQU_INEQU_LVL, MTH_PRE_LVL.PRE_SEE_STRUCT_EXP_LVL, MTH_PRE_LVL.PRE_STAT_PROB_LVL, MTH_PRE_LVL.PRE_NUM_SYS_LVL, MTH_POST_LVL.POST_FREQUENCY_PERIOD_ID, MTH_POST_LVL.POST_ART_POL_RAT_EXP_LVL, MTH_POST_LVL.POST_CRE_EQU_LVL, MTH_POST_LVL.POST_DEMO_MAS_BAS_FACT_LVL, MTH_POST_LVL.POST_EXP_EQU_LVL, MTH_POST_LVL.POST_FUNCTIONS_LVL, MTH_POST_LVL.POST_GEOMET_LVL, MTH_POST_LVL.POST_GEOMET_MEASURE_LVL, MTH_POST_LVL.POST_MATH_PRACTICE_LVL, MTH_POST_LVL.POST_MEASURE_DATA_LVL, MTH_POST_LVL.POST_NUM_OPER_FRACTIONS_LVL, MTH_POST_LVL.POST_NUM_OPER_BASETEN_LVL, MTH_POST_LVL.POST_OPER_ALG_THINK_LVL, MTH_POST_LVL.POST_RATIO_PRO_REL_LVL, MTH_POST_LVL.POST_REA_EQU_INEQU_LVL, MTH_POST_LVL.POST_SEE_STRUCT_EXP_LVL, MTH_POST_LVL.POST_STAT_PROB_LVL, MTH_POST_LVL.POST_NUM_SYS_LVL
FROM (ReportCYData.dbo.EVAL_SB_MATH AS MTH_SB_Orig
LEFT OUTER JOIN
(SELECT MTH_SB.STUDENT_ID,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'PRE' AND MTH_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL)
AS MTH_PRE_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_PRE_LVL.STUDENT_ID))
LEFT OUTER JOIN
(SELECT MTH_SB.STUDENT_ID,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS POST_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE (MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag LIKE 'POST' AND MTH_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL)
AS MTH_POST_LVL
ON (MTH_SB_Orig.STUDENT_ID = MTH_POST_LVL.STUDENT_ID)
WHERE MTH_SB_Orig.FISCAL_YEAR LIKE '2014-2015')
AS prepost ON (ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID))
ON (ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 5)
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015')
AS MTHSBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;