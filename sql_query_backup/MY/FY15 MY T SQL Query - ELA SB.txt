-- This query sets up data for FY15 mid-year student performance data reporting: ELA Standards-Based Course Grades.
-- Steps 1.1, 1.2, and 3 nest within step 4, which nests within step 5. Replace "*****ABOVE_QUERY*****" with the query text in the preceding/specified step.
-- The final section (QUERY SYNTAX (SINGLE QUERY VERSION)) is the final query that should be set up in a stored procedure in the reporting DB. This step is just a copy of all previous steps, properly nested.

-- Step 1.1 and 1.2: Restructure all ELA standards based data (tagged), keeping only scale_local variables. Need one version for pre-tags and one for post-tags.
-- Step 2: Merge scale_local variables to original table dbo_EVAL_SB_ELA.
-- Step 3: Restructure all ELA standards based data (non-tagged).
-- Step 4: Select latest non-tagged administration for proxy data point.
-- Step 5: Merge in columns from RPT_STUDENT_MAIN, RPT_SCHOOL_GRADE, performance level values from the query above, and the selected data points from the query above. Use scale_local variables available from Step 2 for creating new variables at this current step.
-- Step 6: Final calculation of additional variables, based on variables created in Step 5.


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB to obtain performance level variables for pre-tagged data points -- STEP 1.1):

SELECT ELA_SB_PRELVL.STUDENT_ID,
AVG(ELA_SB_PRELVL.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB_PRELVL
WHERE ELA_SB_PRELVL.INDICATOR_AREA_ID = 3 AND ELA_SB_PRELVL.Tag LIKE 'PRE' AND ELA_SB_PRELVL.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB_PRELVL.STUDENT_ID, ELA_SB_PRELVL.INTERVAL;


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB to obtain performance level variables for post-tagged data points -- STEP 1.2):

SELECT ELA_SB_POSTLVL.STUDENT_ID,
AVG(ELA_SB_POSTLVL.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB_POSTLVL
WHERE ELA_SB_POSTLVL.INDICATOR_AREA_ID = 3 AND ELA_SB_POSTLVL.Tag LIKE 'POST' AND ELA_SB_POSTLVL.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB_POSTLVL.STUDENT_ID, ELA_SB_POSTLVL.INTERVAL;


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB for non-tagged data points, so that each row is a single student/time period -- STEP 2):

SELECT ELA_SB.STUDENT_ID, ELA_SB.INTERVAL,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ELA_SIM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ELA_SIM_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_LANG_VOCABUL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_LANG_VOCABUL_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag IS NULL AND ELA_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL;


-- QUERY SYNTAX (Select latest administration for proxy data point -- BASED ON ABOVE QUERY -- STEP 3):

SELECT ELA_SB1.STUDENT_ID, ELA_SB1.INTERVAL AS PROXY_INTERVAL, ELA_SB1.PROXY_FREQUENCY_PERIOD_ID, ELA_SB1.PROXY_CS_INT_WRDS_PRS, ELA_SB1.PROXY_CS_INT_WRDS_PRS_LVL, ELA_SB1.PROXY_CS_ANL_STR_TXTS, ELA_SB1.PROXY_CS_ANL_STR_TXTS_LVL, ELA_SB1.PROXY_CS_ASS_PNT_VW_PUR, ELA_SB1.PROXY_CS_ASS_PNT_VW_PUR_LVL, ELA_SB1.PROXY_ELA_SIM, ELA_SB1.PROXY_ELA_SIM_LVL, ELA_SB1.PROXY_INT_KNW_IDA_INT_EVA_CON, ELA_SB1.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_SB1.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB1.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_SB1.PROXY_INT_KNW_IDA_EVAL_ARG, ELA_SB1.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB1.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB1.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_READ_CLOSE, ELA_SB1.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_SB1.PROXY_LANG_VOCABUL, ELA_SB1.PROXY_LANG_VOCABUL_LVL, ELA_SB1.PROXY_RNGE_READ_LVL_TXT_CMPX, ELA_SB1.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_SB1.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB1.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_SB1.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB1.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM
(*****ABOVE_QUERY STEP 2*****)
AS ELA_SB1 LEFT JOIN
(*****ABOVE_QUERY STEP 2*****)
AS ELA_SB2
ON ELA_SB1.STUDENT_ID = ELA_SB2.STUDENT_ID AND ELA_SB1.PROXY_FREQUENCY_PERIOD_ID < ELA_SB2.PROXY_FREQUENCY_PERIOD_ID
WHERE ELA_SB2.STUDENT_ID IS NULL;


-- QUERY SYNTAX (Merge in pre-tagged performance level columns, post-tagged performance level columns, and selected proxy data point columns to dbo_EVAL_SB_ELA (pre/post data) -- BASED ON ABOVE QUERIES -- STEP 4):

SELECT ELA_SB_Orig.STUDENT_ID, ELA_SB_Orig.PRE_INTERVAL, ELA_SB_Orig.PRE_CS_INT_WRDS_PRS, ELA_SB_Orig.PRE_CS_ANL_STR_TXTS, ELA_SB_Orig.PRE_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.PRE_ELA_SIM, ELA_SB_Orig.PRE_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.PRE_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.PRE_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.PRE_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.PRE_LANG_VOCABUL, ELA_SB_Orig.PRE_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.POST_INTERVAL, ELA_SB_Orig.POST_CS_INT_WRDS_PRS, ELA_SB_Orig.POST_CS_ANL_STR_TXTS, ELA_SB_Orig.POST_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.POST_ELA_SIM, ELA_SB_Orig.POST_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.POST_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.POST_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.POST_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.POST_LANG_VOCABUL, ELA_SB_Orig.POST_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.CURRENTLY_ENROLLED, ELA_SB_Orig.ENROLLED_DAYS, ELA_SB_Orig.ENROLLED_DAYS_CATEGORIES, ELA_SB_Orig.TTL_TIME, ELA_SB_Orig.DOSAGE_CATEGORIES, ELA_SB_Orig.STATUS_SITE_DOSAGE_GOAL, ELA_SB_Orig.SITE_DOSAGE_GOAL, ELA_SB_Orig.Attendance_IA, ELA_SB_Orig.ELA_IA, ELA_SB_Orig.Math_IA, ELA_SB_Orig.Behavior_IA, ELA_SB_Orig.FISCAL_YEAR, ELA_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, ELA_PRE_LVL.PRE_CS_INT_WRDS_PRS_LVL, ELA_PRE_LVL.PRE_CS_ANL_STR_TXTS_LVL, ELA_PRE_LVL.PRE_CS_ASS_PNT_VW_PUR_LVL, ELA_PRE_LVL.PRE_ELA_SIM_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_EVAL_ARG_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_PRE_LVL.PRE_LANG_VOCABUL_LVL, ELA_PRE_LVL.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_PRE_LVL.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_PRE_LVL.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_POST_LVL.POST_FREQUENCY_PERIOD_ID, ELA_POST_LVL.POST_CS_INT_WRDS_PRS_LVL, ELA_POST_LVL.POST_CS_ANL_STR_TXTS_LVL, ELA_POST_LVL.POST_CS_ASS_PNT_VW_PUR_LVL, ELA_POST_LVL.POST_ELA_SIM_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_EVAL_ARG_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_POST_LVL.POST_LANG_VOCABUL_LVL, ELA_POST_LVL.POST_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_POST_LVL.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_POST_LVL.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_SB_PROXY.PROXY_INTERVAL, ELA_SB_PROXY.PROXY_FREQUENCY_PERIOD_ID, ELA_SB_PROXY.PROXY_CS_INT_WRDS_PRS, ELA_SB_PROXY.PROXY_CS_INT_WRDS_PRS_LVL, ELA_SB_PROXY.PROXY_CS_ANL_STR_TXTS, ELA_SB_PROXY.PROXY_CS_ANL_STR_TXTS_LVL, ELA_SB_PROXY.PROXY_CS_ASS_PNT_VW_PUR, ELA_SB_PROXY.PROXY_CS_ASS_PNT_VW_PUR_LVL, ELA_SB_PROXY.PROXY_ELA_SIM, ELA_SB_PROXY.PROXY_ELA_SIM_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_INT_EVA_CON, ELA_SB_PROXY.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_PROXY.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_EVAL_ARG, ELA_SB_PROXY.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_READ_CLOSE, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_SB_PROXY.PROXY_LANG_VOCABUL, ELA_SB_PROXY.PROXY_LANG_VOCABUL_LVL, ELA_SB_PROXY.PROXY_RNGE_READ_LVL_TXT_CMPX, ELA_SB_PROXY.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_SB_PROXY.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_PROXY.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_SB_PROXY.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_PROXY.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ((ReportCYData.dbo.EVAL_SB_ELA AS ELA_SB_Orig
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.1 PRE)*****)
AS ELA_PRE_LVL
ON ELA_SB_Orig.STUDENT_ID = ELA_PRE_LVL.STUDENT_ID)
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.2 POST)*****)
AS ELA_POST_LVL
ON ELA_SB_Orig.STUDENT_ID = ELA_POST_LVL.STUDENT_ID)
LEFT OUTER JOIN
(*****ABOVE_QUERY (STEP 3 PROXY)*****)
ON ELA_SB_Orig.STUDENT_ID = ELA_SB_PROXY.STUDENT_ID
AS ELA_SB_PROXY
WHERE ELA_SB_Orig.FISCAL_YEAR LIKE '2014-2015';


-- QUERY SYNTAX (Merge in columns from RPT_STUDENT_MAIN and RPT_SCHOOL_GRADE. Select post/proxy-post data points, where the post data point is selected if available, otherwise use the proxy performance data. -- BASED ON ABOVE QUERY -- STEP 5)

SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_CS_INT_WRDS_PRS, prepost.PRE_CS_ANL_STR_TXTS, prepost.PRE_CS_ASS_PNT_VW_PUR, prepost.PRE_ELA_SIM, prepost.PRE_INT_KNW_IDA_INT_EVA_CON, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PRE_INT_KNW_IDA_EVAL_ARG, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PRE_KEY_IDEA_DET_READ_CLOSE, prepost.PRE_LANG_VOCABUL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.POST_INTERVAL, prepost.POST_CS_INT_WRDS_PRS, prepost.POST_CS_ANL_STR_TXTS, prepost.POST_CS_ASS_PNT_VW_PUR, prepost.POST_ELA_SIM, prepost.POST_INT_KNW_IDA_INT_EVA_CON, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.POST_INT_KNW_IDA_EVAL_ARG, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.POST_KEY_IDEA_DET_READ_CLOSE, prepost.POST_LANG_VOCABUL, prepost.POST_RNGE_READ_LVL_TXT_CMPX, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, prepost.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, prepost.SB_ELA_SIM_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_CS_INT_WRDS_PRS_LVL, prepost.PRE_CS_ANL_STR_TXTS_LVL, prepost.PRE_CS_ASS_PNT_VW_PUR_LVL, prepost.PRE_ELA_SIM_LVL, prepost.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PRE_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PRE_LANG_VOCABUL_LVL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_CS_INT_WRDS_PRS_LVL, prepost.POST_CS_ANL_STR_TXTS_LVL, prepost.POST_CS_ASS_PNT_VW_PUR_LVL, prepost.POST_ELA_SIM_LVL, prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.POST_LANG_VOCABUL_LVL, prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.FISCAL_YEAR, prepost.PROXY_INTERVAL, prepost.PROXY_FREQUENCY_PERIOD_ID, prepost.PROXY_CS_INT_WRDS_PRS, prepost.PROXY_CS_INT_WRDS_PRS_LVL, prepost.PROXY_CS_ANL_STR_TXTS, prepost.PROXY_CS_ANL_STR_TXTS_LVL, prepost.PROXY_CS_ASS_PNT_VW_PUR, prepost.PROXY_CS_ASS_PNT_VW_PUR_LVL, prepost.PROXY_ELA_SIM, prepost.PROXY_ELA_SIM_LVL, prepost.PROXY_INT_KNW_IDA_INT_EVA_CON, prepost.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PROXY_INT_KNW_IDA_EVAL_ARG, prepost.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PROXY_KEY_IDEA_DET_READ_CLOSE, prepost.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PROXY_LANG_VOCABUL, prepost.PROXY_LANG_VOCABUL_LVL, prepost.PROXY_RNGE_READ_LVL_TXT_CMPX, prepost.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INTERVAL ELSE prepost.POST_INTERVAL END AS MY_INTERVAL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_INT_WRDS_PRS ELSE prepost.POST_CS_INT_WRDS_PRS END AS MY_CS_INT_WRDS_PRS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ANL_STR_TXTS ELSE prepost.POST_CS_ANL_STR_TXTS END AS MY_CS_ANL_STR_TXTS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ASS_PNT_VW_PUR ELSE prepost.POST_CS_ASS_PNT_VW_PUR END AS MY_CS_ASS_PNT_VW_PUR,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_ELA_SIM ELSE prepost.POST_ELA_SIM END AS MY_ELA_SIM,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_INT_EVA_CON ELSE prepost.POST_INT_KNW_IDA_INT_EVA_CON END AS MY_INT_KNW_IDA_INT_EVA_CON,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP ELSE prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_EVAL_ARG ELSE prepost.POST_INT_KNW_IDA_EVAL_ARG END AS MY_INT_KNW_IDA_EVAL_ARG,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT ELSE prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT END AS MY_KEY_IDEA_DET_ANA_DEV_TXT,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME ELSE prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_READ_CLOSE ELSE prepost.POST_KEY_IDEA_DET_READ_CLOSE END AS MY_KEY_IDEA_DET_READ_CLOSE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_LANG_VOCABUL ELSE prepost.POST_LANG_VOCABUL END AS MY_LANG_VOCABUL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RNGE_READ_LVL_TXT_CMPX ELSE prepost.POST_RNGE_READ_LVL_TXT_CMPX END AS MY_RNGE_READ_LVL_TXT_CMPX,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD ELSE prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM ELSE prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_INT_WRDS_PRS_LVL ELSE prepost.POST_CS_INT_WRDS_PRS_LVL END AS MY_CS_INT_WRDS_PRS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ANL_STR_TXTS_LVL ELSE prepost.POST_CS_ANL_STR_TXTS_LVL END AS MY_CS_ANL_STR_TXTS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ASS_PNT_VW_PUR_LVL ELSE prepost.POST_CS_ASS_PNT_VW_PUR_LVL END AS MY_CS_ASS_PNT_VW_PUR_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_ELA_SIM_LVL ELSE prepost.POST_ELA_SIM_LVL END AS MY_ELA_SIM_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL ELSE prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL END AS MY_INT_KNW_IDA_INT_EVA_CON_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_EVAL_ARG_LVL ELSE prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL END AS MY_INT_KNW_IDA_EVAL_ARG_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL ELSE prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL END AS MY_KEY_IDEA_DET_READ_CLOSE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_LANG_VOCABUL_LVL ELSE prepost.POST_LANG_VOCABUL_LVL END AS MY_LANG_VOCABUL_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL ELSE prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL END AS MY_RNGE_READ_LVL_TXT_CMPX_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(*****ABOVE QUERY*****)
AS prepost ON ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)
ON ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3 AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015';


-- QUERY SYNTAX (Re-populate old table, calculate final MY post/proxy-post change variables -- BASED ON ABOVE QUERY -- STEP 6 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_ELA_SB_subtable
SELECT ELASBFINAL.*,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND POST_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + POST_CS_INT_WRDS_PRS_LVL ELSE NULL END AS EOY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND POST_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + POST_CS_ANL_STR_TXTS_LVL ELSE NULL END AS EOY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND POST_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + POST_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS EOY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND POST_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + POST_ELA_SIM_LVL ELSE NULL END AS EOY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND POST_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + POST_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS EOY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS EOY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND POST_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + POST_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS EOY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND POST_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + POST_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND POST_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + POST_LANG_VOCABUL_LVL ELSE NULL END AS EOY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND POST_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + POST_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS EOY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS EOY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS EOY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE,
CASE WHEN PRE_CS_INT_WRDS_PRS IS NOT NULL AND MY_CS_INT_WRDS_PRS IS NOT NULL THEN MY_CS_INT_WRDS_PRS - PRE_CS_INT_WRDS_PRS ELSE NULL END AS MY_CS_INT_WRDS_PRS_CHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS IS NOT NULL AND MY_CS_ANL_STR_TXTS IS NOT NULL THEN MY_CS_ANL_STR_TXTS - PRE_CS_ANL_STR_TXTS ELSE NULL END AS MY_CS_ANL_STR_TXTS_CHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR IS NOT NULL AND MY_CS_ASS_PNT_VW_PUR IS NOT NULL THEN MY_CS_ASS_PNT_VW_PUR - PRE_CS_ASS_PNT_VW_PUR ELSE NULL END AS MY_CS_ASS_PNT_VW_PUR_CHANGE,
CASE WHEN PRE_ELA_SIM IS NOT NULL AND MY_ELA_SIM IS NOT NULL THEN MY_ELA_SIM - PRE_ELA_SIM ELSE NULL END AS MY_ELA_SIM_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON IS NOT NULL AND MY_INT_KNW_IDA_INT_EVA_CON IS NOT NULL THEN MY_INT_KNW_IDA_INT_EVA_CON - PRE_INT_KNW_IDA_INT_EVA_CON ELSE NULL END AS MY_INT_KNW_IDA_INT_EVA_CON_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP IS NOT NULL AND MY_INT_KNW_IDA_ANA_SIM_THEME_TOP IS NOT NULL THEN MY_INT_KNW_IDA_ANA_SIM_THEME_TOP - PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP ELSE NULL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG IS NOT NULL AND MY_INT_KNW_IDA_EVAL_ARG IS NOT NULL THEN MY_INT_KNW_IDA_EVAL_ARG - PRE_INT_KNW_IDA_EVAL_ARG ELSE NULL END AS MY_INT_KNW_IDA_EVAL_ARG_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT IS NOT NULL AND MY_KEY_IDEA_DET_ANA_DEV_TXT IS NOT NULL THEN MY_KEY_IDEA_DET_ANA_DEV_TXT - PRE_KEY_IDEA_DET_ANA_DEV_TXT ELSE NULL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME IS NOT NULL AND MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME IS NOT NULL THEN MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME - PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME ELSE NULL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE IS NOT NULL AND MY_KEY_IDEA_DET_READ_CLOSE IS NOT NULL THEN MY_KEY_IDEA_DET_READ_CLOSE - PRE_KEY_IDEA_DET_READ_CLOSE ELSE NULL END AS MY_KEY_IDEA_DET_READ_CLOSE_CHANGE,
CASE WHEN PRE_LANG_VOCABUL IS NOT NULL AND MY_LANG_VOCABUL IS NOT NULL THEN MY_LANG_VOCABUL - PRE_LANG_VOCABUL ELSE NULL END AS MY_LANG_VOCABUL_CHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX IS NOT NULL AND MY_RNGE_READ_LVL_TXT_CMPX IS NOT NULL THEN MY_RNGE_READ_LVL_TXT_CMPX - PRE_RNGE_READ_LVL_TXT_CMPX ELSE NULL END AS MY_RNGE_READ_LVL_TXT_CMPX_CHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD IS NOT NULL AND MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD IS NOT NULL THEN MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD - PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD ELSE NULL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_CHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM IS NOT NULL AND MY_RD_SUFF_ACCR_FLUEN_SUP_COM IS NOT NULL THEN MY_RD_SUFF_ACCR_FLUEN_SUP_COM - PRE_RD_SUFF_ACCR_FLUEN_SUP_COM ELSE NULL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_CHANGE,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND MY_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + MY_CS_INT_WRDS_PRS_LVL ELSE NULL END AS MY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND MY_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + MY_CS_ANL_STR_TXTS_LVL ELSE NULL END AS MY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND MY_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + MY_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS MY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND MY_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + MY_ELA_SIM_LVL ELSE NULL END AS MY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND MY_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + MY_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS MY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND MY_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + MY_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS MY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND MY_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + MY_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS MY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND MY_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + MY_LANG_VOCABUL_LVL ELSE NULL END AS MY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND MY_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + MY_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS MY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_MY_ELA_SB_subtable
FROM
(*****ABOVE_QUERY*****)
AS ELASBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;


-- QUERY SYNTAX (Merge and concatenate -- SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_ELA_SB_subtable
SELECT ELASBFINAL.*,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND POST_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + POST_CS_INT_WRDS_PRS_LVL ELSE NULL END AS EOY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND POST_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + POST_CS_ANL_STR_TXTS_LVL ELSE NULL END AS EOY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND POST_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + POST_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS EOY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND POST_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + POST_ELA_SIM_LVL ELSE NULL END AS EOY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND POST_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + POST_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS EOY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS EOY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND POST_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + POST_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS EOY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND POST_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + POST_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND POST_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + POST_LANG_VOCABUL_LVL ELSE NULL END AS EOY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND POST_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + POST_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS EOY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS EOY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS EOY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE,
CASE WHEN PRE_CS_INT_WRDS_PRS IS NOT NULL AND MY_CS_INT_WRDS_PRS IS NOT NULL THEN MY_CS_INT_WRDS_PRS - PRE_CS_INT_WRDS_PRS ELSE NULL END AS MY_CS_INT_WRDS_PRS_CHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS IS NOT NULL AND MY_CS_ANL_STR_TXTS IS NOT NULL THEN MY_CS_ANL_STR_TXTS - PRE_CS_ANL_STR_TXTS ELSE NULL END AS MY_CS_ANL_STR_TXTS_CHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR IS NOT NULL AND MY_CS_ASS_PNT_VW_PUR IS NOT NULL THEN MY_CS_ASS_PNT_VW_PUR - PRE_CS_ASS_PNT_VW_PUR ELSE NULL END AS MY_CS_ASS_PNT_VW_PUR_CHANGE,
CASE WHEN PRE_ELA_SIM IS NOT NULL AND MY_ELA_SIM IS NOT NULL THEN MY_ELA_SIM - PRE_ELA_SIM ELSE NULL END AS MY_ELA_SIM_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON IS NOT NULL AND MY_INT_KNW_IDA_INT_EVA_CON IS NOT NULL THEN MY_INT_KNW_IDA_INT_EVA_CON - PRE_INT_KNW_IDA_INT_EVA_CON ELSE NULL END AS MY_INT_KNW_IDA_INT_EVA_CON_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP IS NOT NULL AND MY_INT_KNW_IDA_ANA_SIM_THEME_TOP IS NOT NULL THEN MY_INT_KNW_IDA_ANA_SIM_THEME_TOP - PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP ELSE NULL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_CHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG IS NOT NULL AND MY_INT_KNW_IDA_EVAL_ARG IS NOT NULL THEN MY_INT_KNW_IDA_EVAL_ARG - PRE_INT_KNW_IDA_EVAL_ARG ELSE NULL END AS MY_INT_KNW_IDA_EVAL_ARG_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT IS NOT NULL AND MY_KEY_IDEA_DET_ANA_DEV_TXT IS NOT NULL THEN MY_KEY_IDEA_DET_ANA_DEV_TXT - PRE_KEY_IDEA_DET_ANA_DEV_TXT ELSE NULL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME IS NOT NULL AND MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME IS NOT NULL THEN MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME - PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME ELSE NULL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_CHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE IS NOT NULL AND MY_KEY_IDEA_DET_READ_CLOSE IS NOT NULL THEN MY_KEY_IDEA_DET_READ_CLOSE - PRE_KEY_IDEA_DET_READ_CLOSE ELSE NULL END AS MY_KEY_IDEA_DET_READ_CLOSE_CHANGE,
CASE WHEN PRE_LANG_VOCABUL IS NOT NULL AND MY_LANG_VOCABUL IS NOT NULL THEN MY_LANG_VOCABUL - PRE_LANG_VOCABUL ELSE NULL END AS MY_LANG_VOCABUL_CHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX IS NOT NULL AND MY_RNGE_READ_LVL_TXT_CMPX IS NOT NULL THEN MY_RNGE_READ_LVL_TXT_CMPX - PRE_RNGE_READ_LVL_TXT_CMPX ELSE NULL END AS MY_RNGE_READ_LVL_TXT_CMPX_CHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD IS NOT NULL AND MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD IS NOT NULL THEN MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD - PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD ELSE NULL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_CHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM IS NOT NULL AND MY_RD_SUFF_ACCR_FLUEN_SUP_COM IS NOT NULL THEN MY_RD_SUFF_ACCR_FLUEN_SUP_COM - PRE_RD_SUFF_ACCR_FLUEN_SUP_COM ELSE NULL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_CHANGE,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND MY_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + MY_CS_INT_WRDS_PRS_LVL ELSE NULL END AS MY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND MY_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + MY_CS_ANL_STR_TXTS_LVL ELSE NULL END AS MY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND MY_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + MY_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS MY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND MY_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + MY_ELA_SIM_LVL ELSE NULL END AS MY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND MY_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + MY_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS MY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND MY_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + MY_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS MY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND MY_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + MY_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS MY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND MY_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + MY_LANG_VOCABUL_LVL ELSE NULL END AS MY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND MY_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + MY_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS MY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_MY_ELA_SB_subtable
FROM
(SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_CS_INT_WRDS_PRS, prepost.PRE_CS_ANL_STR_TXTS, prepost.PRE_CS_ASS_PNT_VW_PUR, prepost.PRE_ELA_SIM, prepost.PRE_INT_KNW_IDA_INT_EVA_CON, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PRE_INT_KNW_IDA_EVAL_ARG, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PRE_KEY_IDEA_DET_READ_CLOSE, prepost.PRE_LANG_VOCABUL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.POST_INTERVAL, prepost.POST_CS_INT_WRDS_PRS, prepost.POST_CS_ANL_STR_TXTS, prepost.POST_CS_ASS_PNT_VW_PUR, prepost.POST_ELA_SIM, prepost.POST_INT_KNW_IDA_INT_EVA_CON, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.POST_INT_KNW_IDA_EVAL_ARG, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.POST_KEY_IDEA_DET_READ_CLOSE, prepost.POST_LANG_VOCABUL, prepost.POST_RNGE_READ_LVL_TXT_CMPX, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, prepost.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, prepost.SB_ELA_SIM_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_CS_INT_WRDS_PRS_LVL, prepost.PRE_CS_ANL_STR_TXTS_LVL, prepost.PRE_CS_ASS_PNT_VW_PUR_LVL, prepost.PRE_ELA_SIM_LVL, prepost.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PRE_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PRE_LANG_VOCABUL_LVL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_CS_INT_WRDS_PRS_LVL, prepost.POST_CS_ANL_STR_TXTS_LVL, prepost.POST_CS_ASS_PNT_VW_PUR_LVL, prepost.POST_ELA_SIM_LVL, prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.POST_LANG_VOCABUL_LVL, prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.FISCAL_YEAR, prepost.PROXY_INTERVAL, prepost.PROXY_FREQUENCY_PERIOD_ID, prepost.PROXY_CS_INT_WRDS_PRS, prepost.PROXY_CS_INT_WRDS_PRS_LVL, prepost.PROXY_CS_ANL_STR_TXTS, prepost.PROXY_CS_ANL_STR_TXTS_LVL, prepost.PROXY_CS_ASS_PNT_VW_PUR, prepost.PROXY_CS_ASS_PNT_VW_PUR_LVL, prepost.PROXY_ELA_SIM, prepost.PROXY_ELA_SIM_LVL, prepost.PROXY_INT_KNW_IDA_INT_EVA_CON, prepost.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PROXY_INT_KNW_IDA_EVAL_ARG, prepost.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PROXY_KEY_IDEA_DET_READ_CLOSE, prepost.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PROXY_LANG_VOCABUL, prepost.PROXY_LANG_VOCABUL_LVL, prepost.PROXY_RNGE_READ_LVL_TXT_CMPX, prepost.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INTERVAL ELSE prepost.POST_INTERVAL END AS MY_INTERVAL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_INT_WRDS_PRS ELSE prepost.POST_CS_INT_WRDS_PRS END AS MY_CS_INT_WRDS_PRS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ANL_STR_TXTS ELSE prepost.POST_CS_ANL_STR_TXTS END AS MY_CS_ANL_STR_TXTS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ASS_PNT_VW_PUR ELSE prepost.POST_CS_ASS_PNT_VW_PUR END AS MY_CS_ASS_PNT_VW_PUR,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_ELA_SIM ELSE prepost.POST_ELA_SIM END AS MY_ELA_SIM,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_INT_EVA_CON ELSE prepost.POST_INT_KNW_IDA_INT_EVA_CON END AS MY_INT_KNW_IDA_INT_EVA_CON,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP ELSE prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_EVAL_ARG ELSE prepost.POST_INT_KNW_IDA_EVAL_ARG END AS MY_INT_KNW_IDA_EVAL_ARG,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT ELSE prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT END AS MY_KEY_IDEA_DET_ANA_DEV_TXT,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME ELSE prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_READ_CLOSE ELSE prepost.POST_KEY_IDEA_DET_READ_CLOSE END AS MY_KEY_IDEA_DET_READ_CLOSE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_LANG_VOCABUL ELSE prepost.POST_LANG_VOCABUL END AS MY_LANG_VOCABUL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RNGE_READ_LVL_TXT_CMPX ELSE prepost.POST_RNGE_READ_LVL_TXT_CMPX END AS MY_RNGE_READ_LVL_TXT_CMPX,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD ELSE prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM ELSE prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_INT_WRDS_PRS_LVL ELSE prepost.POST_CS_INT_WRDS_PRS_LVL END AS MY_CS_INT_WRDS_PRS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ANL_STR_TXTS_LVL ELSE prepost.POST_CS_ANL_STR_TXTS_LVL END AS MY_CS_ANL_STR_TXTS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_CS_ASS_PNT_VW_PUR_LVL ELSE prepost.POST_CS_ASS_PNT_VW_PUR_LVL END AS MY_CS_ASS_PNT_VW_PUR_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_ELA_SIM_LVL ELSE prepost.POST_ELA_SIM_LVL END AS MY_ELA_SIM_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL ELSE prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL END AS MY_INT_KNW_IDA_INT_EVA_CON_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL END AS MY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_INT_KNW_IDA_EVAL_ARG_LVL ELSE prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL END AS MY_INT_KNW_IDA_EVAL_ARG_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL END AS MY_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL END AS MY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL ELSE prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL END AS MY_KEY_IDEA_DET_READ_CLOSE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_LANG_VOCABUL_LVL ELSE prepost.POST_LANG_VOCABUL_LVL END AS MY_LANG_VOCABUL_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL ELSE prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL END AS MY_RNGE_READ_LVL_TXT_CMPX_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL END AS MY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'ELA/Literacy PrYr/Cumulative') THEN prepost.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL END AS MY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(SELECT ELA_SB_Orig.STUDENT_ID, ELA_SB_Orig.PRE_INTERVAL, ELA_SB_Orig.PRE_CS_INT_WRDS_PRS, ELA_SB_Orig.PRE_CS_ANL_STR_TXTS, ELA_SB_Orig.PRE_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.PRE_ELA_SIM, ELA_SB_Orig.PRE_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.PRE_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.PRE_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.PRE_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.PRE_LANG_VOCABUL, ELA_SB_Orig.PRE_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.POST_INTERVAL, ELA_SB_Orig.POST_CS_INT_WRDS_PRS, ELA_SB_Orig.POST_CS_ANL_STR_TXTS, ELA_SB_Orig.POST_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.POST_ELA_SIM, ELA_SB_Orig.POST_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.POST_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.POST_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.POST_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.POST_LANG_VOCABUL, ELA_SB_Orig.POST_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.CURRENTLY_ENROLLED, ELA_SB_Orig.ENROLLED_DAYS, ELA_SB_Orig.ENROLLED_DAYS_CATEGORIES, ELA_SB_Orig.TTL_TIME, ELA_SB_Orig.DOSAGE_CATEGORIES, ELA_SB_Orig.STATUS_SITE_DOSAGE_GOAL, ELA_SB_Orig.SITE_DOSAGE_GOAL, ELA_SB_Orig.Attendance_IA, ELA_SB_Orig.ELA_IA, ELA_SB_Orig.Math_IA, ELA_SB_Orig.Behavior_IA, ELA_SB_Orig.FISCAL_YEAR, ELA_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, ELA_PRE_LVL.PRE_CS_INT_WRDS_PRS_LVL, ELA_PRE_LVL.PRE_CS_ANL_STR_TXTS_LVL, ELA_PRE_LVL.PRE_CS_ASS_PNT_VW_PUR_LVL, ELA_PRE_LVL.PRE_ELA_SIM_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_EVAL_ARG_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_PRE_LVL.PRE_LANG_VOCABUL_LVL, ELA_PRE_LVL.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_PRE_LVL.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_PRE_LVL.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_POST_LVL.POST_FREQUENCY_PERIOD_ID, ELA_POST_LVL.POST_CS_INT_WRDS_PRS_LVL, ELA_POST_LVL.POST_CS_ANL_STR_TXTS_LVL, ELA_POST_LVL.POST_CS_ASS_PNT_VW_PUR_LVL, ELA_POST_LVL.POST_ELA_SIM_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_EVAL_ARG_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_POST_LVL.POST_LANG_VOCABUL_LVL, ELA_POST_LVL.POST_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_POST_LVL.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_POST_LVL.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_SB_PROXY.PROXY_INTERVAL, ELA_SB_PROXY.PROXY_FREQUENCY_PERIOD_ID, ELA_SB_PROXY.PROXY_CS_INT_WRDS_PRS, ELA_SB_PROXY.PROXY_CS_INT_WRDS_PRS_LVL, ELA_SB_PROXY.PROXY_CS_ANL_STR_TXTS, ELA_SB_PROXY.PROXY_CS_ANL_STR_TXTS_LVL, ELA_SB_PROXY.PROXY_CS_ASS_PNT_VW_PUR, ELA_SB_PROXY.PROXY_CS_ASS_PNT_VW_PUR_LVL, ELA_SB_PROXY.PROXY_ELA_SIM, ELA_SB_PROXY.PROXY_ELA_SIM_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_INT_EVA_CON, ELA_SB_PROXY.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_PROXY.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_SB_PROXY.PROXY_INT_KNW_IDA_EVAL_ARG, ELA_SB_PROXY.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_READ_CLOSE, ELA_SB_PROXY.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_SB_PROXY.PROXY_LANG_VOCABUL, ELA_SB_PROXY.PROXY_LANG_VOCABUL_LVL, ELA_SB_PROXY.PROXY_RNGE_READ_LVL_TXT_CMPX, ELA_SB_PROXY.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_SB_PROXY.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_PROXY.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_SB_PROXY.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_PROXY.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ((ReportCYData.dbo.EVAL_SB_ELA AS ELA_SB_Orig
LEFT OUTER JOIN
(SELECT ELA_SB_PRELVL.STUDENT_ID,
AVG(ELA_SB_PRELVL.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB_PRELVL
WHERE ELA_SB_PRELVL.INDICATOR_AREA_ID = 3 AND ELA_SB_PRELVL.Tag LIKE 'PRE' AND ELA_SB_PRELVL.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB_PRELVL.STUDENT_ID, ELA_SB_PRELVL.INTERVAL)
AS ELA_PRE_LVL
ON ELA_SB_Orig.STUDENT_ID = ELA_PRE_LVL.STUDENT_ID)
LEFT OUTER JOIN
(SELECT ELA_SB_POSTLVL.STUDENT_ID,
AVG(ELA_SB_POSTLVL.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB_POSTLVL
WHERE ELA_SB_POSTLVL.INDICATOR_AREA_ID = 3 AND ELA_SB_POSTLVL.Tag LIKE 'POST' AND ELA_SB_POSTLVL.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB_POSTLVL.STUDENT_ID, ELA_SB_POSTLVL.INTERVAL)
AS ELA_POST_LVL
ON ELA_SB_Orig.STUDENT_ID = ELA_POST_LVL.STUDENT_ID)
LEFT OUTER JOIN
(SELECT ELA_SB1.STUDENT_ID, ELA_SB1.INTERVAL AS PROXY_INTERVAL, ELA_SB1.PROXY_FREQUENCY_PERIOD_ID, ELA_SB1.PROXY_CS_INT_WRDS_PRS, ELA_SB1.PROXY_CS_INT_WRDS_PRS_LVL, ELA_SB1.PROXY_CS_ANL_STR_TXTS, ELA_SB1.PROXY_CS_ANL_STR_TXTS_LVL, ELA_SB1.PROXY_CS_ASS_PNT_VW_PUR, ELA_SB1.PROXY_CS_ASS_PNT_VW_PUR_LVL, ELA_SB1.PROXY_ELA_SIM, ELA_SB1.PROXY_ELA_SIM_LVL, ELA_SB1.PROXY_INT_KNW_IDA_INT_EVA_CON, ELA_SB1.PROXY_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_SB1.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB1.PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_SB1.PROXY_INT_KNW_IDA_EVAL_ARG, ELA_SB1.PROXY_INT_KNW_IDA_EVAL_ARG_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB1.PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB1.PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_SB1.PROXY_KEY_IDEA_DET_READ_CLOSE, ELA_SB1.PROXY_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_SB1.PROXY_LANG_VOCABUL, ELA_SB1.PROXY_LANG_VOCABUL_LVL, ELA_SB1.PROXY_RNGE_READ_LVL_TXT_CMPX, ELA_SB1.PROXY_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_SB1.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB1.PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_SB1.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB1.PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM
(SELECT ELA_SB.STUDENT_ID, ELA_SB.INTERVAL,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ELA_SIM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ELA_SIM_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_LANG_VOCABUL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_LANG_VOCABUL_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag IS NULL AND ELA_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL)
AS ELA_SB1 LEFT JOIN
(SELECT ELA_SB.STUDENT_ID, ELA_SB.INTERVAL,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_INT_WRDS_PRS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ANL_STR_TXTS_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CS_ASS_PNT_VW_PUR_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ELA_SIM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ELA_SIM_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_INT_EVA_CON_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_INT_KNW_IDA_EVAL_ARG_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KEY_IDEA_DET_READ_CLOSE_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_LANG_VOCABUL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_LANG_VOCABUL_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RNGE_READ_LVL_TXT_CMPX_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
AVG(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag IS NULL AND ELA_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL)
AS ELA_SB2
ON ELA_SB1.STUDENT_ID = ELA_SB2.STUDENT_ID AND ELA_SB1.PROXY_FREQUENCY_PERIOD_ID < ELA_SB2.PROXY_FREQUENCY_PERIOD_ID
WHERE ELA_SB2.STUDENT_ID IS NULL)
AS ELA_SB_PROXY
ON ELA_SB_Orig.STUDENT_ID = ELA_SB_PROXY.STUDENT_ID
WHERE ELA_SB_Orig.FISCAL_YEAR LIKE '2014-2015')
AS prepost ON ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)
ON ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3 AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015')
AS ELASBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;