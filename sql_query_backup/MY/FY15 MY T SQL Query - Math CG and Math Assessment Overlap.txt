-- This query sets up data for FY15 mid-year student performance data reporting: Math Assessments and MTH Course Grades COMBO.
-- Step 1 nests within step 2, which nests within step 3. Replace "*****ABOVE_QUERY*****" with the query text in the preceding step.
-- The final section (QUERY SYNTAX (SINGLE QUERY VERSION)) is the final query that should be set up in a stored procedure in the reporting DB. This step is just a copy of all previous steps, properly nested.


-- QUERY SYNTAX (Merge dbo_FY15_MY_MTH_ASSESS_subtable and dbo_FY15_MY_MTH_CG_subtable -- STEP 1):

SELECT CASE WHEN prepost_MTH.STUDENT_ID IS NOT NULL THEN prepost_MTH.STUDENT_ID ELSE prepost_MTHCG.STUDENT_ID END AS STUDENT_ID_COMBO,
CASE WHEN prepost_MTH.SCHOOL_ID IS NOT NULL THEN prepost_MTH.SCHOOL_ID ELSE prepost_MTHCG.SCHOOL_ID END AS SCHOOL_ID_COMBO,
prepost_MTH.ASSESSMENT_TYPE, prepost_MTH.PRE_VALUE, prepost_MTH.PRE_VALUE_DISPLAY, prepost_MTH.PRE_VALUE_NUM, prepost_MTH.PRE_DATE, prepost_MTH.PRE_DESC, prepost_MTH.PRE_TRACK, prepost_MTH.PRE_TRACK_EVAL, prepost_MTH.PRE_TRACK_NATIONAL, prepost_MTH.POST_VALUE, prepost_MTH.POST_VALUE_DISPLAY, prepost_MTH.POST_VALUE_NUM, prepost_MTH.POST_DATE, prepost_MTH.POST_DESC, prepost_MTH.POST_TRACK, prepost_MTH.POST_TRACK_EVAL, prepost_MTH.POST_TRACK_NATIONAL, prepost_MTH.LIT_ASSESS_RAWCHANGE, prepost_MTH.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_MTH.LIT_ASSESS_PERCENTCHANGE, prepost_MTH.MY_PERF_DATE, prepost_MTH.MY_DESC, prepost_MTH.MY_VALUE_NUM, prepost_MTH.MY_TRACK_NUM, prepost_MTH.MY_TRACK, prepost_MTH.MY_TRACK_EVAL, prepost_MTH.MY_RAWCHANGE_DEGREE, prepost_MTH.MY_PERFORMANCECHANGE_LOCAL, prepost_MTH.MY_PERFORMANCECHANGE_NORMALIZED,
prepost_MTHCG.PRE_MATH_CG_VALUE, prepost_MTHCG.PRE_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.PRE_MATH_CG_VALUE_NUM, prepost_MTHCG.PRE_MATH_DESC, prepost_MTHCG.PRE_MATH_FREQ, prepost_MTHCG.PRE_MATH_TRACK, prepost_MTHCG.PRE_MATH_TRACK_EVAL, prepost_MTHCG.PRE_SCENARIO, prepost_MTHCG.PRE_LETTER_VIEW, prepost_MTHCG.PRE_CG_LETTER_SCALE_ALL, prepost_MTHCG.POST_MATH_CG_VALUE, prepost_MTHCG.POST_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.POST_MATH_CG_VALUE_NUM, prepost_MTHCG.POST_MATH_DESC, prepost_MTHCG.POST_MATH_FREQ, prepost_MTHCG.POST_MATH_TRACK, prepost_MTHCG.POST_MATH_TRACK_EVAL, prepost_MTHCG.POST_SCENARIO, prepost_MTHCG.POST_LETTER_VIEW, prepost_MTHCG.POST_CG_LETTER_SCALE_ALL, prepost_MTHCG.LETTERGADE_CHANGE_ACTUAL, prepost_MTHCG.LETTERGADE_CHANGE_GENERAL, prepost_MTHCG.CG_Performance_Level_Change, prepost_MTHCG.CG_Change, prepost_MTHCG.MY_MATH_FREQ, prepost_MTHCG.MY_MATH_TRACK, prepost_MTHCG.MY_LETTER_VIEW, prepost_MTHCG.MY_CG_LETTER_SCALE_ALL, prepost_MTHCG.MY_LETTERGRADE_CHANGE_ACTUAL, prepost_MTHCG.MY_PERF_CHANGE, prepost_MTHCG.OG_PRE_MTH_CG_NUM, prepost_MTHCG.OG_POST_MTH_CG_NUM, prepost_MTHCG.OG_PROXY_MTH_CG_NUM, prepost_MTHCG.OG_MY_MTH_CG_NUM, prepost_MTHCG.MY_Change, prepost_MTHCG.OG_MY_MTH_CG_CHANGE, prepost_MTHCG.OG_EOY_MTH_CG_CHANGE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE_NUM,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE_NUM,
CASE WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS MY_MTHA_MTHCG_MY_COMPARE,
CASE WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_MTHA_MTHCG_MY_COMPARE_NUM
FROM
ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_subtable
AS prepost_MTH FULL OUTER JOIN
ImpactAnalytics.dbo.FY15_MY_MTH_CG_subtable
AS prepost_MTHCG
ON prepost_MTH.STUDENT_ID = prepost_MTHCG.STUDENT_ID;


-- QUERY SYNTAX (BASED ON ABOVE QUERY -- STEP 2 -- this step merges in enrollment, dosage, other student-related data, and dosage goal data. This step is necessary because we can't rely on pulling this info from only the math assessment table, or only the math CG table, since there are students who may only have data in one table or the other.)

SELECT student_main.SITE_NAME, student_main.SCHOOL_NAME, student_main.GRADE_ID,
CASE WHEN student_main.GRADE_ID = 21 THEN -1 WHEN student_main.GRADE_ID = 22 THEN 0 ELSE student_main.GRADE_ID END AS GRADE_ID_RECODE,
student_main.DIPLOMAS_NOW_SCHOOL, student_main.STUDENT_ID, student_main.SCHOOL_ID, student_main.FISCAL_YEAR, student_main.Attendance_IA, student_main.ELA_IA, student_main.Math_IA, student_main.Behavior_IA, 
student_enrollment.CURRRENTLY_ENROLLED AS CURRENTLY_ENROLLED, student_enrollment.ENROLLED_DAYS,
CASE WHEN student_enrollment.ENROLLED_DAYS >= 30 THEN 'Enrolled for 30+ days' WHEN student_enrollment.ENROLLED_DAYS < 30 THEN 'Enrolled for <30 days' ELSE NULL END AS ENROLLED_DAYS_CATEGORIES,
student_dosage.DOSAGE_CATEGORY, student_dosage.TTL_TIME,
CASE WHEN student_dosage.TTL_TIME >= school_grade.B_RULE_VAL1 THEN 1 ELSE 0 END AS STATUS_SITE_DOSAGE_GOAL,
school_grade.B_RULE_VAL1 AS SITE_DOSAGE_GOAL, school_grade.INDICATOR_ID, school_grade.B_RULE_VAL1, school_grade.B_RULE_VAL2, school_grade.B_RULE_VAL3, school_grade.B_RULE_VAL4, school_grade.B_RULE_VAL5,
CASE WHEN student_dosage.TTL_TIME >= school_grade.B_RULE_VAL2 THEN 1 WHEN student_dosage.TTL_TIME < school_grade.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
prepostcombo.ASSESSMENT_TYPE, prepostcombo.PRE_VALUE, prepostcombo.PRE_VALUE_DISPLAY, prepostcombo.PRE_VALUE_NUM, prepostcombo.PRE_DATE, prepostcombo.PRE_DESC, prepostcombo.PRE_TRACK, prepostcombo.PRE_TRACK_EVAL, prepostcombo.PRE_TRACK_NATIONAL, prepostcombo.POST_VALUE, prepostcombo.POST_VALUE_DISPLAY, prepostcombo.POST_VALUE_NUM, prepostcombo.POST_DATE, prepostcombo.POST_DESC, prepostcombo.POST_TRACK, prepostcombo.POST_TRACK_EVAL, prepostcombo.POST_TRACK_NATIONAL, prepostcombo.LIT_ASSESS_RAWCHANGE, prepostcombo.LIT_ASSESS_RAWCHANGE_DEGREE, prepostcombo.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepostcombo.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepostcombo.LIT_ASSESS_PERCENTCHANGE, prepostcombo.MY_PERF_DATE, prepostcombo.MY_DESC, prepostcombo.MY_VALUE_NUM, prepostcombo.MY_TRACK_NUM, prepostcombo.MY_TRACK, prepostcombo.MY_TRACK_EVAL, prepostcombo.MY_RAWCHANGE_DEGREE, prepostcombo.MY_PERFORMANCECHANGE_LOCAL, prepostcombo.MY_PERFORMANCECHANGE_NORMALIZED,
prepostcombo.PRE_MATH_CG_VALUE, prepostcombo.PRE_MATH_CG_VALUE_DISPLAY, prepostcombo.PRE_MATH_CG_VALUE_NUM, prepostcombo.PRE_MATH_DESC, prepostcombo.PRE_MATH_FREQ, prepostcombo.PRE_MATH_TRACK, prepostcombo.PRE_MATH_TRACK_EVAL, prepostcombo.PRE_SCENARIO, prepostcombo.PRE_LETTER_VIEW, prepostcombo.PRE_CG_LETTER_SCALE_ALL, prepostcombo.POST_MATH_CG_VALUE, prepostcombo.POST_MATH_CG_VALUE_DISPLAY, prepostcombo.POST_MATH_CG_VALUE_NUM, prepostcombo.POST_MATH_DESC, prepostcombo.POST_MATH_FREQ, prepostcombo.POST_MATH_TRACK, prepostcombo.POST_MATH_TRACK_EVAL, prepostcombo.POST_SCENARIO, prepostcombo.POST_LETTER_VIEW, prepostcombo.POST_CG_LETTER_SCALE_ALL, prepostcombo.LETTERGADE_CHANGE_ACTUAL, prepostcombo.LETTERGADE_CHANGE_GENERAL, prepostcombo.CG_Performance_Level_Change, prepostcombo.CG_Change, prepostcombo.MY_MATH_FREQ, prepostcombo.MY_MATH_TRACK, prepostcombo.MY_LETTER_VIEW, prepostcombo.MY_CG_LETTER_SCALE_ALL, prepostcombo.MY_LETTERGRADE_CHANGE_ACTUAL, prepostcombo.MY_PERF_CHANGE, prepostcombo.OG_PRE_MTH_CG_NUM, prepostcombo.OG_POST_MTH_CG_NUM, prepostcombo.OG_PROXY_MTH_CG_NUM, prepostcombo.OG_MY_MTH_CG_NUM, prepostcombo.MY_Change, prepostcombo.OG_MY_MTH_CG_CHANGE, prepostcombo.OG_EOY_MTH_CG_CHANGE,
prepostcombo.EOY_MTHA_MTHCG_PRE_COMPARE, prepostcombo.EOY_MTHA_MTHCG_PRE_COMPARE_NUM, prepostcombo.EOY_MTHA_MTHCG_POST_COMPARE, prepostcombo.EOY_MTHA_MTHCG_POST_COMPARE_NUM, prepostcombo.MY_MTHA_MTHCG_MY_COMPARE, prepostcombo.MY_MTHA_MTHCG_MY_COMPARE_NUM
FROM
(*****ABOVE QUERY*****)
AS prepostcombo LEFT JOIN
(ReportCYData.dbo.RPT_SCHOOL_GRADE AS school_grade RIGHT JOIN
(ReportCYData.dbo.RPT_STUDENT_MAIN AS student_main LEFT JOIN
(ReportCYData.dbo.RPT_STUDENT_ENROLLMENT AS student_enrollment LEFT JOIN ReportCYData.dbo.RPT_STUDENT_TIME_LINEAR AS student_dosage
ON student_enrollment.STUDENT_ID = student_dosage.STUDENT_ID)
ON student_main.STUDENT_ID = student_enrollment.STUDENT_ID)
ON school_grade.SCHOOL_ID = student_main.SCHOOL_ID AND school_grade.GRADE_ID = student_main.GRADE_ID)
ON prepostcombo.STUDENT_ID_COMBO = student_main.STUDENT_ID
WHERE school_grade.FISCAL_YEAR LIKE '2014-2015' AND school_grade.INDICATOR_ID = 5 AND student_enrollment.INDICATOR_AREA_DESC LIKE 'Math' AND student_dosage.INDICATOR_AREA_DESC LIKE 'Math';


-- QUERY SYNTAX (BASED ON ABOVE QUERY -- STEP 3 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_MTH_CG_subtable
SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAON_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAON_MTHCGOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_MTH_CG_subtable
FROM
(*****ABOVE_QUERY*****)
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;


-- QUERY SYNTAX (SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_MTH_CG_subtable
SELECT PPPFINAL.*,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.EOY_MTHA_MTHCG_POST_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS EOY_MTHAON_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAOFF_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAOFF_MTHCGOFF_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Both Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments and Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAON_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAON_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Moved Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Moved On-Track in Assessments and Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Remained Off-Track/Sliding in Assessments, Remained On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved On-Track in Assessments, Moved Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAOFF_MTHCGON_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAOFF_MTHCGON_CHANGE_NUM,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Remained Off-Track/Sliding in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 'Remained On-Track in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 'Moved Off-Track/Sliding in Assessments, Moved On-Track in Math CG' WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 'Remained On-Track in Assessments, Remained Off-Track/Sliding in Math CG' ELSE NULL END AS MY_MTHAON_MTHCGOFF_CHANGE,
CASE WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' THEN 4 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, On-Track in Math CG' THEN 1 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'Off-Track/Sliding in Assessments, On-Track in Math CG' THEN 3 WHEN PPPFINAL.EOY_MTHA_MTHCG_PRE_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' AND PPPFINAL.MY_MTHA_MTHCG_MY_COMPARE LIKE 'On-Track in Assessments, Off-Track/Sliding in Math CG' THEN 2 ELSE NULL END AS MY_MTHAON_MTHCGOFF_CHANGE_NUM
INTO ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_MTH_CG_subtable
FROM
(SELECT student_main.SITE_NAME, student_main.SCHOOL_NAME, student_main.GRADE_ID,
CASE WHEN student_main.GRADE_ID = 21 THEN -1 WHEN student_main.GRADE_ID = 22 THEN 0 ELSE student_main.GRADE_ID END AS GRADE_ID_RECODE,
student_main.DIPLOMAS_NOW_SCHOOL, student_main.STUDENT_ID, student_main.SCHOOL_ID, student_main.FISCAL_YEAR, student_main.Attendance_IA, student_main.ELA_IA, student_main.Math_IA, student_main.Behavior_IA, 
student_enrollment.CURRRENTLY_ENROLLED AS CURRENTLY_ENROLLED, student_enrollment.ENROLLED_DAYS,
CASE WHEN student_enrollment.ENROLLED_DAYS >= 30 THEN 'Enrolled for 30+ days' WHEN student_enrollment.ENROLLED_DAYS < 30 THEN 'Enrolled for <30 days' ELSE NULL END AS ENROLLED_DAYS_CATEGORIES,
student_dosage.DOSAGE_CATEGORY, student_dosage.TTL_TIME,
CASE WHEN student_dosage.TTL_TIME >= school_grade.B_RULE_VAL1 THEN 1 ELSE 0 END AS STATUS_SITE_DOSAGE_GOAL,
school_grade.B_RULE_VAL1 AS SITE_DOSAGE_GOAL, school_grade.INDICATOR_ID, school_grade.B_RULE_VAL1, school_grade.B_RULE_VAL2, school_grade.B_RULE_VAL3, school_grade.B_RULE_VAL4, school_grade.B_RULE_VAL5,
CASE WHEN student_dosage.TTL_TIME >= school_grade.B_RULE_VAL2 THEN 1 WHEN student_dosage.TTL_TIME < school_grade.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
prepostcombo.ASSESSMENT_TYPE, prepostcombo.PRE_VALUE, prepostcombo.PRE_VALUE_DISPLAY, prepostcombo.PRE_VALUE_NUM, prepostcombo.PRE_DATE, prepostcombo.PRE_DESC, prepostcombo.PRE_TRACK, prepostcombo.PRE_TRACK_EVAL, prepostcombo.PRE_TRACK_NATIONAL, prepostcombo.POST_VALUE, prepostcombo.POST_VALUE_DISPLAY, prepostcombo.POST_VALUE_NUM, prepostcombo.POST_DATE, prepostcombo.POST_DESC, prepostcombo.POST_TRACK, prepostcombo.POST_TRACK_EVAL, prepostcombo.POST_TRACK_NATIONAL, prepostcombo.LIT_ASSESS_RAWCHANGE, prepostcombo.LIT_ASSESS_RAWCHANGE_DEGREE, prepostcombo.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepostcombo.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepostcombo.LIT_ASSESS_PERCENTCHANGE, prepostcombo.MY_PERF_DATE, prepostcombo.MY_DESC, prepostcombo.MY_VALUE_NUM, prepostcombo.MY_TRACK_NUM, prepostcombo.MY_TRACK, prepostcombo.MY_TRACK_EVAL, prepostcombo.MY_RAWCHANGE_DEGREE, prepostcombo.MY_PERFORMANCECHANGE_LOCAL, prepostcombo.MY_PERFORMANCECHANGE_NORMALIZED,
prepostcombo.PRE_MATH_CG_VALUE, prepostcombo.PRE_MATH_CG_VALUE_DISPLAY, prepostcombo.PRE_MATH_CG_VALUE_NUM, prepostcombo.PRE_MATH_DESC, prepostcombo.PRE_MATH_FREQ, prepostcombo.PRE_MATH_TRACK, prepostcombo.PRE_MATH_TRACK_EVAL, prepostcombo.PRE_SCENARIO, prepostcombo.PRE_LETTER_VIEW, prepostcombo.PRE_CG_LETTER_SCALE_ALL, prepostcombo.POST_MATH_CG_VALUE, prepostcombo.POST_MATH_CG_VALUE_DISPLAY, prepostcombo.POST_MATH_CG_VALUE_NUM, prepostcombo.POST_MATH_DESC, prepostcombo.POST_MATH_FREQ, prepostcombo.POST_MATH_TRACK, prepostcombo.POST_MATH_TRACK_EVAL, prepostcombo.POST_SCENARIO, prepostcombo.POST_LETTER_VIEW, prepostcombo.POST_CG_LETTER_SCALE_ALL, prepostcombo.LETTERGADE_CHANGE_ACTUAL, prepostcombo.LETTERGADE_CHANGE_GENERAL, prepostcombo.CG_Performance_Level_Change, prepostcombo.CG_Change, prepostcombo.MY_MATH_FREQ, prepostcombo.MY_MATH_TRACK, prepostcombo.MY_LETTER_VIEW, prepostcombo.MY_CG_LETTER_SCALE_ALL, prepostcombo.MY_LETTERGRADE_CHANGE_ACTUAL, prepostcombo.MY_PERF_CHANGE, prepostcombo.OG_PRE_MTH_CG_NUM, prepostcombo.OG_POST_MTH_CG_NUM, prepostcombo.OG_PROXY_MTH_CG_NUM, prepostcombo.OG_MY_MTH_CG_NUM, prepostcombo.MY_Change, prepostcombo.OG_MY_MTH_CG_CHANGE, prepostcombo.OG_EOY_MTH_CG_CHANGE,
prepostcombo.EOY_MTHA_MTHCG_PRE_COMPARE, prepostcombo.EOY_MTHA_MTHCG_PRE_COMPARE_NUM, prepostcombo.EOY_MTHA_MTHCG_POST_COMPARE, prepostcombo.EOY_MTHA_MTHCG_POST_COMPARE_NUM, prepostcombo.MY_MTHA_MTHCG_MY_COMPARE, prepostcombo.MY_MTHA_MTHCG_MY_COMPARE_NUM
FROM
(SELECT CASE WHEN prepost_MTH.STUDENT_ID IS NOT NULL THEN prepost_MTH.STUDENT_ID ELSE prepost_MTHCG.STUDENT_ID END AS STUDENT_ID_COMBO,
CASE WHEN prepost_MTH.SCHOOL_ID IS NOT NULL THEN prepost_MTH.SCHOOL_ID ELSE prepost_MTHCG.SCHOOL_ID END AS SCHOOL_ID_COMBO,
prepost_MTH.ASSESSMENT_TYPE, prepost_MTH.PRE_VALUE, prepost_MTH.PRE_VALUE_DISPLAY, prepost_MTH.PRE_VALUE_NUM, prepost_MTH.PRE_DATE, prepost_MTH.PRE_DESC, prepost_MTH.PRE_TRACK, prepost_MTH.PRE_TRACK_EVAL, prepost_MTH.PRE_TRACK_NATIONAL, prepost_MTH.POST_VALUE, prepost_MTH.POST_VALUE_DISPLAY, prepost_MTH.POST_VALUE_NUM, prepost_MTH.POST_DATE, prepost_MTH.POST_DESC, prepost_MTH.POST_TRACK, prepost_MTH.POST_TRACK_EVAL, prepost_MTH.POST_TRACK_NATIONAL, prepost_MTH.LIT_ASSESS_RAWCHANGE, prepost_MTH.LIT_ASSESS_RAWCHANGE_DEGREE, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_LOCAL, prepost_MTH.LIT_ASSESS_PERFORMANCECHANGE_NORMALIZED, prepost_MTH.LIT_ASSESS_PERCENTCHANGE, prepost_MTH.MY_PERF_DATE, prepost_MTH.MY_DESC, prepost_MTH.MY_VALUE_NUM, prepost_MTH.MY_TRACK_NUM, prepost_MTH.MY_TRACK, prepost_MTH.MY_TRACK_EVAL, prepost_MTH.MY_RAWCHANGE_DEGREE, prepost_MTH.MY_PERFORMANCECHANGE_LOCAL, prepost_MTH.MY_PERFORMANCECHANGE_NORMALIZED,
prepost_MTHCG.PRE_MATH_CG_VALUE, prepost_MTHCG.PRE_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.PRE_MATH_CG_VALUE_NUM, prepost_MTHCG.PRE_MATH_DESC, prepost_MTHCG.PRE_MATH_FREQ, prepost_MTHCG.PRE_MATH_TRACK, prepost_MTHCG.PRE_MATH_TRACK_EVAL, prepost_MTHCG.PRE_SCENARIO, prepost_MTHCG.PRE_LETTER_VIEW, prepost_MTHCG.PRE_CG_LETTER_SCALE_ALL, prepost_MTHCG.POST_MATH_CG_VALUE, prepost_MTHCG.POST_MATH_CG_VALUE_DISPLAY, prepost_MTHCG.POST_MATH_CG_VALUE_NUM, prepost_MTHCG.POST_MATH_DESC, prepost_MTHCG.POST_MATH_FREQ, prepost_MTHCG.POST_MATH_TRACK, prepost_MTHCG.POST_MATH_TRACK_EVAL, prepost_MTHCG.POST_SCENARIO, prepost_MTHCG.POST_LETTER_VIEW, prepost_MTHCG.POST_CG_LETTER_SCALE_ALL, prepost_MTHCG.LETTERGADE_CHANGE_ACTUAL, prepost_MTHCG.LETTERGADE_CHANGE_GENERAL, prepost_MTHCG.CG_Performance_Level_Change, prepost_MTHCG.CG_Change, prepost_MTHCG.MY_MATH_FREQ, prepost_MTHCG.MY_MATH_TRACK, prepost_MTHCG.MY_LETTER_VIEW, prepost_MTHCG.MY_CG_LETTER_SCALE_ALL, prepost_MTHCG.MY_LETTERGRADE_CHANGE_ACTUAL, prepost_MTHCG.MY_PERF_CHANGE, prepost_MTHCG.OG_PRE_MTH_CG_NUM, prepost_MTHCG.OG_POST_MTH_CG_NUM, prepost_MTHCG.OG_PROXY_MTH_CG_NUM, prepost_MTHCG.OG_MY_MTH_CG_NUM, prepost_MTHCG.MY_Change, prepost_MTHCG.OG_MY_MTH_CG_CHANGE, prepost_MTHCG.OG_EOY_MTH_CG_CHANGE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE,
CASE WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.PRE_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.PRE_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.PRE_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.PRE_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_PRE_COMPARE_NUM,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE,
CASE WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.POST_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.POST_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.POST_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.POST_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS EOY_MTHA_MTHCG_POST_COMPARE_NUM,
CASE WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 'Off-Track/Sliding in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 'Off-Track/Sliding in Assessments, On-Track in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 'On-Track in Assessments, Off-Track/Sliding in Math CG' WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 'On-Track in Assessments, On-Track in Math CG' ELSE NULL END AS MY_MTHA_MTHCG_MY_COMPARE,
CASE WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 4 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'OFF TRACK' OR prepost_MTH.MY_TRACK_EVAL LIKE 'SLIDING') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 3 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'OFF TRACK' OR prepost_MTHCG.MY_MATH_TRACK LIKE 'SLIDING') THEN 2 WHEN (prepost_MTH.MY_TRACK_EVAL LIKE 'ON TRACK') AND (prepost_MTHCG.MY_MATH_TRACK LIKE 'ON TRACK') THEN 1 ELSE NULL END AS MY_MTHA_MTHCG_MY_COMPARE_NUM
FROM
ImpactAnalytics.dbo.FY15_MY_MTH_ASSESS_subtable
AS prepost_MTH FULL OUTER JOIN
ImpactAnalytics.dbo.FY15_MY_MTH_CG_subtable
AS prepost_MTHCG
ON prepost_MTH.STUDENT_ID = prepost_MTHCG.STUDENT_ID)
AS prepostcombo LEFT JOIN
(ReportCYData.dbo.RPT_SCHOOL_GRADE AS school_grade RIGHT JOIN
(ReportCYData.dbo.RPT_STUDENT_MAIN AS student_main LEFT JOIN
(ReportCYData.dbo.RPT_STUDENT_ENROLLMENT AS student_enrollment LEFT JOIN ReportCYData.dbo.RPT_STUDENT_TIME_LINEAR AS student_dosage
ON student_enrollment.STUDENT_ID = student_dosage.STUDENT_ID)
ON student_main.STUDENT_ID = student_enrollment.STUDENT_ID)
ON school_grade.SCHOOL_ID = student_main.SCHOOL_ID AND school_grade.GRADE_ID = student_main.GRADE_ID)
ON prepostcombo.STUDENT_ID_COMBO = student_main.STUDENT_ID
WHERE school_grade.FISCAL_YEAR LIKE '2014-2015' AND school_grade.INDICATOR_ID = 5 AND student_enrollment.INDICATOR_AREA_DESC LIKE 'Math' AND student_dosage.INDICATOR_AREA_DESC LIKE 'Math')
AS PPPFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;