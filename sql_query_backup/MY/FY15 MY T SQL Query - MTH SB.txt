-- This query sets up data for FY15 mid-year student performance data reporting: MTH Standards-Based Course Grades.
-- Steps 1.1, 1.2, and 3 nest within step 4, which nests within step 5. Replace "*****ABOVE_QUERY*****" with the query text in the preceding/specified step.
-- The final section (QUERY SYNTAX (SINGLE QUERY VERSION)) is the final query that should be set up in a stored procedure in the reporting DB. This step is just a copy of all previous steps, properly nested.

-- Step 1.1 and 1.2: Restructure all MTH standards based data (tagged), keeping only scale_local variables. Need one version for pre-tags and one for post-tags.
-- Step 2: Merge scale_local variables to original table dbo_EVAL_SB_MATH.
-- Step 3: Restructure all MTH standards based data (non-tagged).
-- Step 4: Select latest non-tagged administration for proxy data point.
-- Step 5: Merge in columns from RPT_STUDENT_MAIN, RPT_SCHOOL_GRADE, performance level values from the query above, and the selected data points from the query above. Use scale_local variables available from Step 2 for creating new variables at this current step.
-- Step 6: Final calculation of additional variables, based on variables created in Step 5.


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB to obtain performance level variables for pre-tagged data points -- STEP 1.1):

SELECT MTH_SB_PRELVL.STUDENT_ID,
AVG(MTH_SB_PRELVL.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB_PRELVL
WHERE (MTH_SB_PRELVL.INDICATOR_AREA_ID = 5 AND MTH_SB_PRELVL.Tag LIKE 'PRE' AND MTH_SB_PRELVL.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB_PRELVL.STUDENT_ID, MTH_SB_PRELVL.INTERVAL;


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB to obtain performance level variables for post-tagged data points -- STEP 1.2):

SELECT MTH_SB_POSTLVL.STUDENT_ID,
AVG(MTH_SB_POSTLVL.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB_POSTLVL
WHERE (MTH_SB_POSTLVL.INDICATOR_AREA_ID = 5 AND MTH_SB_POSTLVL.Tag LIKE 'POST' AND MTH_SB_POSTLVL.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB_POSTLVL.STUDENT_ID, MTH_SB_POSTLVL.INTERVAL;


-- QUERY SYNTAX (Restructure dbo_RPT_PERFORMANCE_LEVEL_SB for non-tagged data points, so that each row is a single student/time period -- STEP 2):

SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ART_POL_RAT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ART_POL_RAT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CRE_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CRE_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_EXP_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_EXP_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_FUNCTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_FUNCTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET_MEASURE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_MEASURE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MATH_PRACTICE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MATH_PRACTICE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MEASURE_DATA,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MEASURE_DATA_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_BASETEN,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_BASETEN_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_OPER_ALG_THINK,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_OPER_ALG_THINK_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RATIO_PRO_REL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RATIO_PRO_REL_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_REA_EQU_INEQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_REA_EQU_INEQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_SEE_STRUCT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_SEE_STRUCT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_STAT_PROB,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_STAT_PROB_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_SYS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag IS NULL AND MTH_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL;


-- QUERY SYNTAX (Select latest administration for proxy data point -- BASED ON ABOVE QUERY -- STEP 3):

SELECT MTH_SB1.STUDENT_ID, MTH_SB1.INTERVAL AS PROXY_INTERVAL, MTH_SB1.PROXY_FREQUENCY_PERIOD_ID, MTH_SB1.PROXY_ART_POL_RAT_EXP, MTH_SB1.PROXY_ART_POL_RAT_EXP_LVL, MTH_SB1.PROXY_CRE_EQU, MTH_SB1.PROXY_CRE_EQU_LVL, MTH_SB1.PROXY_DEMO_MAS_BAS_FACT, MTH_SB1.PROXY_DEMO_MAS_BAS_FACT_LVL, MTH_SB1.PROXY_EXP_EQU, MTH_SB1.PROXY_EXP_EQU_LVL, MTH_SB1.PROXY_FUNCTIONS, MTH_SB1.PROXY_FUNCTIONS_LVL, MTH_SB1.PROXY_GEOMET, MTH_SB1.PROXY_GEOMET_LVL, MTH_SB1.PROXY_GEOMET_MEASURE, MTH_SB1.PROXY_GEOMET_MEASURE_LVL, MTH_SB1.PROXY_MATH_PRACTICE, MTH_SB1.PROXY_MATH_PRACTICE_LVL, MTH_SB1.PROXY_MEASURE_DATA, MTH_SB1.PROXY_MEASURE_DATA_LVL, MTH_SB1.PROXY_NUM_OPER_FRACTIONS, MTH_SB1.PROXY_NUM_OPER_FRACTIONS_LVL, MTH_SB1.PROXY_NUM_OPER_BASETEN, MTH_SB1.PROXY_NUM_OPER_BASETEN_LVL, MTH_SB1.PROXY_OPER_ALG_THINK, MTH_SB1.PROXY_OPER_ALG_THINK_LVL, MTH_SB1.PROXY_RATIO_PRO_REL, MTH_SB1.PROXY_RATIO_PRO_REL_LVL, MTH_SB1.PROXY_REA_EQU_INEQU, MTH_SB1.PROXY_REA_EQU_INEQU_LVL, MTH_SB1.PROXY_SEE_STRUCT_EXP, MTH_SB1.PROXY_SEE_STRUCT_EXP_LVL, MTH_SB1.PROXY_STAT_PROB, MTH_SB1.PROXY_STAT_PROB_LVL, MTH_SB1.PROXY_NUM_SYS, MTH_SB1.PROXY_NUM_SYS_LVL
FROM
(*****ABOVE_QUERY STEP 2*****)
AS MTH_SB1 LEFT JOIN
(*****ABOVE_QUERY STEP 2*****)
AS MTH_SB2
ON MTH_SB1.STUDENT_ID = MTH_SB2.STUDENT_ID AND MTH_SB1.PROXY_FREQUENCY_PERIOD_ID < MTH_SB2.PROXY_FREQUENCY_PERIOD_ID
WHERE MTH_SB2.STUDENT_ID IS NULL;


-- QUERY SYNTAX (Merge in pre-tagged performance level columns, post-tagged performance level columns, and selected proxy data point columns to dbo_EVAL_SB_ELA (pre/post data) -- BASED ON ABOVE QUERIES -- STEP 4):

SELECT MTH_SB_Orig.STUDENT_ID, MTH_SB_Orig.PRE_INTERVAL, MTH_SB_Orig.PRE_ART_POL_RAT_EXP, MTH_SB_Orig.PRE_CRE_EQU, MTH_SB_Orig.PRE_DEMO_MAS_BAS_FACT, MTH_SB_Orig.PRE_EXP_EQU, MTH_SB_Orig.PRE_FUNCTIONS, MTH_SB_Orig.PRE_GEOMET, MTH_SB_Orig.PRE_GEOMET_MEASURE, MTH_SB_Orig.PRE_MATH_PRACTICE, MTH_SB_Orig.PRE_MEASURE_DATA, MTH_SB_Orig.PRE_NUM_OPER_FRACTIONS, MTH_SB_Orig.PRE_NUM_OPER_BASETEN, MTH_SB_Orig.PRE_OPER_ALG_THINK, MTH_SB_Orig.PRE_RATIO_PRO_REL, MTH_SB_Orig.PRE_REA_EQU_INEQU, MTH_SB_Orig.PRE_SEE_STRUCT_EXP, MTH_SB_Orig.PRE_STAT_PROB, MTH_SB_Orig.PRE_NUM_SYS, MTH_SB_Orig.POST_INTERVAL, MTH_SB_Orig.POST_ART_POL_RAT_EXP, MTH_SB_Orig.POST_CRE_EQU, MTH_SB_Orig.POST_DEMO_MAS_BAS_FACT, MTH_SB_Orig.POST_EXP_EQU, MTH_SB_Orig.POST_FUNCTIONS, MTH_SB_Orig.POST_GEOMET, MTH_SB_Orig.POST_GEOMET_MEASURE, MTH_SB_Orig.POST_MATH_PRACTICE, MTH_SB_Orig.POST_MEASURE_DATA, MTH_SB_Orig.POST_NUM_OPER_FRACTIONS, MTH_SB_Orig.POST_NUM_OPER_BASETEN, MTH_SB_Orig.POST_OPER_ALG_THINK, MTH_SB_Orig.POST_RATIO_PRO_REL, MTH_SB_Orig.POST_REA_EQU_INEQU, MTH_SB_Orig.POST_SEE_STRUCT_EXP, MTH_SB_Orig.POST_STAT_PROB, MTH_SB_Orig.POST_NUM_SYS, MTH_SB_Orig.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.CURRENTLY_ENROLLED, MTH_SB_Orig.ENROLLED_DAYS, MTH_SB_Orig.ENROLLED_DAYS_CATEGORIES, MTH_SB_Orig.TTL_TIME, MTH_SB_Orig.DOSAGE_CATEGORIES, MTH_SB_Orig.STATUS_SITE_DOSAGE_GOAL, MTH_SB_Orig.SITE_DOSAGE_GOAL, MTH_SB_Orig.Attendance_IA, MTH_SB_Orig.ELA_IA, MTH_SB_Orig.Math_IA, MTH_SB_Orig.Behavior_IA, MTH_SB_Orig.FISCAL_YEAR, MTH_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, MTH_PRE_LVL.PRE_ART_POL_RAT_EXP_LVL, MTH_PRE_LVL.PRE_CRE_EQU_LVL, MTH_PRE_LVL.PRE_DEMO_MAS_BAS_FACT_LVL, MTH_PRE_LVL.PRE_EXP_EQU_LVL, MTH_PRE_LVL.PRE_FUNCTIONS_LVL, MTH_PRE_LVL.PRE_GEOMET_LVL, MTH_PRE_LVL.PRE_GEOMET_MEASURE_LVL, MTH_PRE_LVL.PRE_MATH_PRACTICE_LVL, MTH_PRE_LVL.PRE_MEASURE_DATA_LVL, MTH_PRE_LVL.PRE_NUM_OPER_FRACTIONS_LVL, MTH_PRE_LVL.PRE_NUM_OPER_BASETEN_LVL, MTH_PRE_LVL.PRE_OPER_ALG_THINK_LVL, MTH_PRE_LVL.PRE_RATIO_PRO_REL_LVL, MTH_PRE_LVL.PRE_REA_EQU_INEQU_LVL, MTH_PRE_LVL.PRE_SEE_STRUCT_EXP_LVL, MTH_PRE_LVL.PRE_STAT_PROB_LVL, MTH_PRE_LVL.PRE_NUM_SYS_LVL, MTH_POST_LVL.POST_FREQUENCY_PERIOD_ID, MTH_POST_LVL.POST_ART_POL_RAT_EXP_LVL, MTH_POST_LVL.POST_CRE_EQU_LVL, MTH_POST_LVL.POST_DEMO_MAS_BAS_FACT_LVL, MTH_POST_LVL.POST_EXP_EQU_LVL, MTH_POST_LVL.POST_FUNCTIONS_LVL, MTH_POST_LVL.POST_GEOMET_LVL, MTH_POST_LVL.POST_GEOMET_MEASURE_LVL, MTH_POST_LVL.POST_MATH_PRACTICE_LVL, MTH_POST_LVL.POST_MEASURE_DATA_LVL, MTH_POST_LVL.POST_NUM_OPER_FRACTIONS_LVL, MTH_POST_LVL.POST_NUM_OPER_BASETEN_LVL, MTH_POST_LVL.POST_OPER_ALG_THINK_LVL, MTH_POST_LVL.POST_RATIO_PRO_REL_LVL, MTH_POST_LVL.POST_REA_EQU_INEQU_LVL, MTH_POST_LVL.POST_SEE_STRUCT_EXP_LVL, MTH_POST_LVL.POST_STAT_PROB_LVL, MTH_POST_LVL.POST_NUM_SYS_LVL, MTH_SB_PROXY.PROXY_INTERVAL, MTH_SB_PROXY.PROXY_FREQUENCY_PERIOD_ID, MTH_SB_PROXY.PROXY_ART_POL_RAT_EXP, MTH_SB_PROXY.PROXY_ART_POL_RAT_EXP_LVL, MTH_SB_PROXY.PROXY_CRE_EQU, MTH_SB_PROXY.PROXY_CRE_EQU_LVL, MTH_SB_PROXY.PROXY_DEMO_MAS_BAS_FACT, MTH_SB_PROXY.PROXY_DEMO_MAS_BAS_FACT_LVL, MTH_SB_PROXY.PROXY_EXP_EQU, MTH_SB_PROXY.PROXY_EXP_EQU_LVL, MTH_SB_PROXY.PROXY_FUNCTIONS, MTH_SB_PROXY.PROXY_FUNCTIONS_LVL, MTH_SB_PROXY.PROXY_GEOMET, MTH_SB_PROXY.PROXY_GEOMET_LVL, MTH_SB_PROXY.PROXY_GEOMET_MEASURE, MTH_SB_PROXY.PROXY_GEOMET_MEASURE_LVL, MTH_SB_PROXY.PROXY_MATH_PRACTICE, MTH_SB_PROXY.PROXY_MATH_PRACTICE_LVL, MTH_SB_PROXY.PROXY_MEASURE_DATA, MTH_SB_PROXY.PROXY_MEASURE_DATA_LVL, MTH_SB_PROXY.PROXY_NUM_OPER_FRACTIONS, MTH_SB_PROXY.PROXY_NUM_OPER_FRACTIONS_LVL, MTH_SB_PROXY.PROXY_NUM_OPER_BASETEN, MTH_SB_PROXY.PROXY_NUM_OPER_BASETEN_LVL, MTH_SB_PROXY.PROXY_OPER_ALG_THINK, MTH_SB_PROXY.PROXY_OPER_ALG_THINK_LVL, MTH_SB_PROXY.PROXY_RATIO_PRO_REL, MTH_SB_PROXY.PROXY_RATIO_PRO_REL_LVL, MTH_SB_PROXY.PROXY_REA_EQU_INEQU, MTH_SB_PROXY.PROXY_REA_EQU_INEQU_LVL, MTH_SB_PROXY.PROXY_SEE_STRUCT_EXP, MTH_SB_PROXY.PROXY_SEE_STRUCT_EXP_LVL, MTH_SB_PROXY.PROXY_STAT_PROB, MTH_SB_PROXY.PROXY_STAT_PROB_LVL, MTH_SB_PROXY.PROXY_NUM_SYS, MTH_SB_PROXY.PROXY_NUM_SYS_LVL
FROM ((ReportCYData.dbo.EVAL_SB_MATH AS MTH_SB_Orig
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.1 PRE)*****)
AS MTH_PRE_LVL
ON MTH_SB_Orig.STUDENT_ID = MTH_PRE_LVL.STUDENT_ID)
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.2 POST)*****)
AS MTH_POST_LVL
ON MTH_SB_Orig.STUDENT_ID = MTH_POST_LVL.STUDENT_ID)
LEFT OUTER JOIN
(*****ABOVE_QUERY (STEP 3 PROXY)*****)
AS MTH_SB_PROXY
ON MTH_SB_Orig.STUDENT_ID = MTH_SB_PROXY.STUDENT_ID
WHERE MTH_SB_Orig.FISCAL_YEAR LIKE '2014-2015';


-- QUERY SYNTAX (Merge in columns from RPT_STUDENT_MAIN and RPT_SCHOOL_GRADE. Select post/proxy-post data points, where the post data point is selected if available, otherwise use the proxy performance data. -- BASED ON ABOVE QUERY -- STEP 5)

SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_ART_POL_RAT_EXP, prepost.PRE_CRE_EQU, prepost.PRE_DEMO_MAS_BAS_FACT, prepost.PRE_EXP_EQU, prepost.PRE_FUNCTIONS, prepost.PRE_GEOMET, prepost.PRE_GEOMET_MEASURE, prepost.PRE_MATH_PRACTICE, prepost.PRE_MEASURE_DATA, prepost.PRE_NUM_OPER_FRACTIONS, prepost.PRE_NUM_OPER_BASETEN, prepost.PRE_OPER_ALG_THINK, prepost.PRE_RATIO_PRO_REL, prepost.PRE_REA_EQU_INEQU, prepost.PRE_SEE_STRUCT_EXP, prepost.PRE_STAT_PROB, prepost.PRE_NUM_SYS, prepost.POST_INTERVAL, prepost.POST_ART_POL_RAT_EXP, prepost.POST_CRE_EQU, prepost.POST_DEMO_MAS_BAS_FACT, prepost.POST_EXP_EQU, prepost.POST_FUNCTIONS, prepost.POST_GEOMET, prepost.POST_GEOMET_MEASURE, prepost.POST_MATH_PRACTICE, prepost.POST_MEASURE_DATA, prepost.POST_NUM_OPER_FRACTIONS, prepost.POST_NUM_OPER_BASETEN, prepost.POST_OPER_ALG_THINK, prepost.POST_RATIO_PRO_REL, prepost.POST_REA_EQU_INEQU, prepost.POST_SEE_STRUCT_EXP, prepost.POST_STAT_PROB, prepost.POST_NUM_SYS, prepost.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, prepost.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, prepost.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, prepost.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_CRE_EQU_GRADE_CHANGE_DEGREE, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, prepost.SB_EXP_EQU_GRADE_CHANGE_DEGREE, prepost.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, prepost.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_STAT_PROB_GRADE_CHANGE_DEGREE, prepost.SB_NUM_SYS_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_ART_POL_RAT_EXP_LVL, prepost.PRE_CRE_EQU_LVL, prepost.PRE_DEMO_MAS_BAS_FACT_LVL, prepost.PRE_EXP_EQU_LVL, prepost.PRE_FUNCTIONS_LVL, prepost.PRE_GEOMET_LVL, prepost.PRE_GEOMET_MEASURE_LVL, prepost.PRE_MATH_PRACTICE_LVL, prepost.PRE_MEASURE_DATA_LVL, prepost.PRE_NUM_OPER_FRACTIONS_LVL, prepost.PRE_NUM_OPER_BASETEN_LVL, prepost.PRE_OPER_ALG_THINK_LVL, prepost.PRE_RATIO_PRO_REL_LVL, prepost.PRE_REA_EQU_INEQU_LVL, prepost.PRE_SEE_STRUCT_EXP_LVL, prepost.PRE_STAT_PROB_LVL, prepost.PRE_NUM_SYS_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_ART_POL_RAT_EXP_LVL, prepost.POST_CRE_EQU_LVL, prepost.POST_DEMO_MAS_BAS_FACT_LVL, prepost.POST_EXP_EQU_LVL, prepost.POST_FUNCTIONS_LVL, prepost.POST_GEOMET_LVL, prepost.POST_GEOMET_MEASURE_LVL, prepost.POST_MATH_PRACTICE_LVL, prepost.POST_MEASURE_DATA_LVL, prepost.POST_NUM_OPER_FRACTIONS_LVL, prepost.POST_NUM_OPER_BASETEN_LVL, prepost.POST_OPER_ALG_THINK_LVL, prepost.POST_RATIO_PRO_REL_LVL, prepost.POST_REA_EQU_INEQU_LVL, prepost.POST_SEE_STRUCT_EXP_LVL, prepost.POST_STAT_PROB_LVL, prepost.POST_NUM_SYS_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_INTERVAL ELSE prepost.POST_INTERVAL END AS MY_INTERVAL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_ART_POL_RAT_EXP ELSE prepost.POST_ART_POL_RAT_EXP END AS MY_ART_POL_RAT_EXP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_CRE_EQU ELSE prepost.POST_CRE_EQU END AS MY_CRE_EQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_DEMO_MAS_BAS_FACT ELSE prepost.POST_DEMO_MAS_BAS_FACT END AS MY_DEMO_MAS_BAS_FACT,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_EXP_EQU ELSE prepost.POST_EXP_EQU END AS MY_EXP_EQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_FUNCTIONS ELSE prepost.POST_FUNCTIONS END AS MY_FUNCTIONS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET ELSE prepost.POST_GEOMET END AS MY_GEOMET,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_MEASURE ELSE prepost.POST_GEOMET_MEASURE END AS MY_GEOMET_MEASURE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MATH_PRACTICE ELSE prepost.POST_MATH_PRACTICE END AS MY_MATH_PRACTICE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MEASURE_DATA ELSE prepost.POST_MEASURE_DATA END AS MY_MEASURE_DATA,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_FRACTIONS ELSE prepost.POST_NUM_OPER_FRACTIONS END AS MY_NUM_OPER_FRACTIONS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_BASETEN ELSE prepost.POST_NUM_OPER_BASETEN END AS MY_NUM_OPER_BASETEN,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_OPER_ALG_THINK ELSE prepost.POST_OPER_ALG_THINK END AS MY_OPER_ALG_THINK,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_RATIO_PRO_REL ELSE prepost.POST_RATIO_PRO_REL END AS MY_RATIO_PRO_REL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_REA_EQU_INEQU ELSE prepost.POST_REA_EQU_INEQU END AS MY_REA_EQU_INEQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_SEE_STRUCT_EXP ELSE prepost.POST_SEE_STRUCT_EXP END AS MY_SEE_STRUCT_EXP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_STAT_PROB ELSE prepost.POST_STAT_PROB END AS MY_STAT_PROB,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_SYS ELSE prepost.POST_NUM_SYS END AS MY_NUM_SYS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_ART_POL_RAT_EXP_LVL ELSE prepost.POST_ART_POL_RAT_EXP_LVL END AS MY_ART_POL_RAT_EXP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_CRE_EQU_LVL ELSE prepost.POST_CRE_EQU_LVL END AS MY_CRE_EQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_DEMO_MAS_BAS_FACT_LVL ELSE prepost.POST_DEMO_MAS_BAS_FACT_LVL END AS MY_DEMO_MAS_BAS_FACT_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_EXP_EQU_LVL ELSE prepost.POST_EXP_EQU_LVL END AS MY_EXP_EQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_FUNCTIONS_LVL ELSE prepost.POST_FUNCTIONS_LVL END AS MY_FUNCTIONS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_LVL ELSE prepost.POST_GEOMET_LVL END AS MY_GEOMET_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_MEASURE_LVL ELSE prepost.POST_GEOMET_MEASURE_LVL END AS MY_GEOMET_MEASURE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MATH_PRACTICE_LVL ELSE prepost.POST_MATH_PRACTICE_LVL END AS MY_MATH_PRACTICE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MEASURE_DATA_LVL ELSE prepost.POST_MEASURE_DATA_LVL END AS MY_MEASURE_DATA_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_FRACTIONS_LVL ELSE prepost.POST_NUM_OPER_FRACTIONS_LVL END AS MY_NUM_OPER_FRACTIONS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_BASETEN_LVL ELSE prepost.POST_NUM_OPER_BASETEN_LVL END AS MY_NUM_OPER_BASETEN_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_OPER_ALG_THINK_LVL ELSE prepost.POST_OPER_ALG_THINK_LVL END AS MY_OPER_ALG_THINK_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_RATIO_PRO_REL_LVL ELSE prepost.POST_RATIO_PRO_REL_LVL END AS MY_RATIO_PRO_REL_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_REA_EQU_INEQU_LVL ELSE prepost.POST_REA_EQU_INEQU_LVL END AS MY_REA_EQU_INEQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_SEE_STRUCT_EXP_LVL ELSE prepost.POST_SEE_STRUCT_EXP_LVL END AS MY_SEE_STRUCT_EXP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_STAT_PROB_LVL ELSE prepost.POST_STAT_PROB_LVL END AS MY_STAT_PROB_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_SYS_LVL ELSE prepost.POST_NUM_SYS_LVL END AS MY_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(*****ABOVE QUERY*****)
AS prepost ON ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)
ON ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 5 AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015';


-- QUERY SYNTAX (Re-populate old table, calculate final MY post/proxy-post change variables -- BASED ON ABOVE QUERY -- STEP 6 -- this extra step is required since calculations/joins on new variables can't reference variables that were just created in the same query):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_MTH_SB_subtable
SELECT MTHSBFINAL.*,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND POST_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + POST_ART_POL_RAT_EXP_LVL ELSE NULL END AS EOY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND POST_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + POST_CRE_EQU_LVL ELSE NULL END AS EOY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND POST_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + POST_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS EOY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND POST_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + POST_EXP_EQU_LVL ELSE NULL END AS EOY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND POST_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + POST_FUNCTIONS_LVL ELSE NULL END AS EOY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND POST_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + POST_GEOMET_LVL ELSE NULL END AS EOY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND POST_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + POST_GEOMET_MEASURE_LVL ELSE NULL END AS EOY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND POST_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + POST_MATH_PRACTICE_LVL ELSE NULL END AS EOY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND POST_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + POST_MEASURE_DATA_LVL ELSE NULL END AS EOY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND POST_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + POST_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS EOY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND POST_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + POST_NUM_OPER_BASETEN_LVL ELSE NULL END AS EOY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND POST_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + POST_OPER_ALG_THINK_LVL ELSE NULL END AS EOY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND POST_RATIO_PRO_REL_LVIS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + POST_RATIO_PRO_REL_LVL ELSE NULL END AS EOY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND POST_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + POST_REA_EQU_INEQU_LVL ELSE NULL END AS EOY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND POST_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + POST_SEE_STRUCT_EXP_LVL ELSE NULL END AS EOY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND POST_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + POST_STAT_PROB_LVL ELSE NULL END AS EOY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND POST_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + POST_NUM_SYS_LVL ELSE NULL END AS EOY_NUM_SYS_PERFCHANGE,
CASE WHEN PRE_ART_POL_RAT_EXP IS NOT NULL AND MY_ART_POL_RAT_EXP IS NOT NULL THEN MY_ART_POL_RAT_EXP - PRE_ART_POL_RAT_EXP ELSE NULL END AS MY_ART_POL_RAT_EXP_CHANGE,
CASE WHEN PRE_CRE_EQU IS NOT NULL AND MY_CRE_EQU IS NOT NULL THEN MY_CRE_EQU - PRE_CRE_EQU ELSE NULL END AS MY_CRE_EQU_CHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT IS NOT NULL AND MY_DEMO_MAS_BAS_FACT IS NOT NULL THEN MY_DEMO_MAS_BAS_FACT - PRE_DEMO_MAS_BAS_FACT ELSE NULL END AS MY_DEMO_MAS_BAS_FACT_CHANGE,
CASE WHEN PRE_EXP_EQU IS NOT NULL AND MY_EXP_EQU IS NOT NULL THEN MY_EXP_EQU - PRE_EXP_EQU ELSE NULL END AS MY_EXP_EQU_CHANGE,
CASE WHEN PRE_FUNCTIONS IS NOT NULL AND MY_FUNCTIONS IS NOT NULL THEN MY_FUNCTIONS - PRE_FUNCTIONS ELSE NULL END AS MY_FUNCTIONS_CHANGE,
CASE WHEN PRE_GEOMET IS NOT NULL AND MY_GEOMET IS NOT NULL THEN MY_GEOMET - PRE_GEOMET ELSE NULL END AS MY_GEOMET_CHANGE,
CASE WHEN PRE_GEOMET_MEASURE IS NOT NULL AND MY_GEOMET_MEASURE IS NOT NULL THEN MY_GEOMET_MEASURE - PRE_GEOMET_MEASURE ELSE NULL END AS MY_GEOMET_MEASURE_CHANGE,
CASE WHEN PRE_MATH_PRACTICE IS NOT NULL AND MY_MATH_PRACTICE IS NOT NULL THEN MY_MATH_PRACTICE - PRE_MATH_PRACTICE ELSE NULL END AS MY_MATH_PRACTICE_CHANGE,
CASE WHEN PRE_MEASURE_DATA IS NOT NULL AND MY_MEASURE_DATA IS NOT NULL THEN MY_MEASURE_DATA - PRE_MEASURE_DATA ELSE NULL END AS MY_MEASURE_DATA_CHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS IS NOT NULL AND MY_NUM_OPER_FRACTIONS IS NOT NULL THEN MY_NUM_OPER_FRACTIONS - PRE_NUM_OPER_FRACTIONS ELSE NULL END AS MY_NUM_OPER_FRACTIONS_CHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN IS NOT NULL AND MY_NUM_OPER_BASETEN IS NOT NULL THEN MY_NUM_OPER_BASETEN - PRE_NUM_OPER_BASETEN ELSE NULL END AS MY_NUM_OPER_BASETEN_CHANGE,
CASE WHEN PRE_OPER_ALG_THINK IS NOT NULL AND MY_OPER_ALG_THINK IS NOT NULL THEN MY_OPER_ALG_THINK - PRE_OPER_ALG_THINK ELSE NULL END AS MY_OPER_ALG_THINK_CHANGE,
CASE WHEN PRE_RATIO_PRO_REL IS NOT NULL AND MY_RATIO_PRO_REL IS NOT NULL THEN MY_RATIO_PRO_REL - PRE_RATIO_PRO_REL ELSE NULL END AS MY_RATIO_PRO_REL_CHANGE,
CASE WHEN PRE_REA_EQU_INEQU IS NOT NULL AND MY_REA_EQU_INEQU IS NOT NULL THEN MY_REA_EQU_INEQU - PRE_REA_EQU_INEQU ELSE NULL END AS MY_REA_EQU_INEQU_CHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP IS NOT NULL AND MY_SEE_STRUCT_EXP IS NOT NULL THEN MY_SEE_STRUCT_EXP - PRE_SEE_STRUCT_EXP ELSE NULL END AS MY_SEE_STRUCT_EXP_CHANGE,
CASE WHEN PRE_STAT_PROB IS NOT NULL AND MY_STAT_PROB IS NOT NULL THEN MY_STAT_PROB - PRE_STAT_PROB ELSE NULL END AS MY_STAT_PROB_CHANGE,
CASE WHEN PRE_NUM_SYS IS NOT NULL AND MY_NUM_SYS IS NOT NULL THEN MY_NUM_SYS - PRE_NUM_SYS ELSE NULL END AS MY_NUM_SYS_CHANGE,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND MY_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + MY_ART_POL_RAT_EXP_LVL ELSE NULL END AS MY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND MY_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + MY_CRE_EQU_LVL ELSE NULL END AS MY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND MY_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + MY_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS MY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND MY_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + MY_EXP_EQU_LVL ELSE NULL END AS MY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND MY_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + MY_FUNCTIONS_LVL ELSE NULL END AS MY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND MY_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + MY_GEOMET_LVL ELSE NULL END AS MY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND MY_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + MY_GEOMET_MEASURE_LVL ELSE NULL END AS MY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND MY_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + MY_MATH_PRACTICE_LVL ELSE NULL END AS MY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND MY_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + MY_MEASURE_DATA_LVL ELSE NULL END AS MY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND MY_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + MY_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS MY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND MY_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + MY_NUM_OPER_BASETEN_LVL ELSE NULL END AS MY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND MY_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + MY_OPER_ALG_THINK_LVL ELSE NULL END AS MY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND MY_RATIO_PRO_REL_LVL IS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + MY_RATIO_PRO_REL_LVL ELSE NULL END AS MY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND MY_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + MY_REA_EQU_INEQU_LVL ELSE NULL END AS MY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND MY_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + MY_SEE_STRUCT_EXP_LVL ELSE NULL END AS MY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND MY_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + MY_STAT_PROB_LVL ELSE NULL END AS MY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND MY_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + MY_NUM_SYS_LVL ELSE NULL END AS MY_NUM_SYS_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_MY_MTH_SB_subtable
FROM
(*****ABOVE_QUERY*****)
AS MTHSBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;


-- QUERY SYNTAX (Merge and concatenate -- SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY15_MY_MTH_SB_subtable
SELECT MTHSBFINAL.*,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND POST_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + POST_ART_POL_RAT_EXP_LVL ELSE NULL END AS EOY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND POST_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + POST_CRE_EQU_LVL ELSE NULL END AS EOY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND POST_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + POST_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS EOY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND POST_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + POST_EXP_EQU_LVL ELSE NULL END AS EOY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND POST_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + POST_FUNCTIONS_LVL ELSE NULL END AS EOY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND POST_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + POST_GEOMET_LVL ELSE NULL END AS EOY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND POST_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + POST_GEOMET_MEASURE_LVL ELSE NULL END AS EOY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND POST_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + POST_MATH_PRACTICE_LVL ELSE NULL END AS EOY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND POST_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + POST_MEASURE_DATA_LVL ELSE NULL END AS EOY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND POST_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + POST_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS EOY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND POST_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + POST_NUM_OPER_BASETEN_LVL ELSE NULL END AS EOY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND POST_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + POST_OPER_ALG_THINK_LVL ELSE NULL END AS EOY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND POST_RATIO_PRO_REL_LVL IS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + POST_RATIO_PRO_REL_LVL ELSE NULL END AS EOY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND POST_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + POST_REA_EQU_INEQU_LVL ELSE NULL END AS EOY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND POST_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + POST_SEE_STRUCT_EXP_LVL ELSE NULL END AS EOY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND POST_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + POST_STAT_PROB_LVL ELSE NULL END AS EOY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND POST_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + POST_NUM_SYS_LVL ELSE NULL END AS EOY_NUM_SYS_PERFCHANGE,
CASE WHEN PRE_ART_POL_RAT_EXP IS NOT NULL AND MY_ART_POL_RAT_EXP IS NOT NULL THEN MY_ART_POL_RAT_EXP - PRE_ART_POL_RAT_EXP ELSE NULL END AS MY_ART_POL_RAT_EXP_CHANGE,
CASE WHEN PRE_CRE_EQU IS NOT NULL AND MY_CRE_EQU IS NOT NULL THEN MY_CRE_EQU - PRE_CRE_EQU ELSE NULL END AS MY_CRE_EQU_CHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT IS NOT NULL AND MY_DEMO_MAS_BAS_FACT IS NOT NULL THEN MY_DEMO_MAS_BAS_FACT - PRE_DEMO_MAS_BAS_FACT ELSE NULL END AS MY_DEMO_MAS_BAS_FACT_CHANGE,
CASE WHEN PRE_EXP_EQU IS NOT NULL AND MY_EXP_EQU IS NOT NULL THEN MY_EXP_EQU - PRE_EXP_EQU ELSE NULL END AS MY_EXP_EQU_CHANGE,
CASE WHEN PRE_FUNCTIONS IS NOT NULL AND MY_FUNCTIONS IS NOT NULL THEN MY_FUNCTIONS - PRE_FUNCTIONS ELSE NULL END AS MY_FUNCTIONS_CHANGE,
CASE WHEN PRE_GEOMET IS NOT NULL AND MY_GEOMET IS NOT NULL THEN MY_GEOMET - PRE_GEOMET ELSE NULL END AS MY_GEOMET_CHANGE,
CASE WHEN PRE_GEOMET_MEASURE IS NOT NULL AND MY_GEOMET_MEASURE IS NOT NULL THEN MY_GEOMET_MEASURE - PRE_GEOMET_MEASURE ELSE NULL END AS MY_GEOMET_MEASURE_CHANGE,
CASE WHEN PRE_MATH_PRACTICE IS NOT NULL AND MY_MATH_PRACTICE IS NOT NULL THEN MY_MATH_PRACTICE - PRE_MATH_PRACTICE ELSE NULL END AS MY_MATH_PRACTICE_CHANGE,
CASE WHEN PRE_MEASURE_DATA IS NOT NULL AND MY_MEASURE_DATA IS NOT NULL THEN MY_MEASURE_DATA - PRE_MEASURE_DATA ELSE NULL END AS MY_MEASURE_DATA_CHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS IS NOT NULL AND MY_NUM_OPER_FRACTIONS IS NOT NULL THEN MY_NUM_OPER_FRACTIONS - PRE_NUM_OPER_FRACTIONS ELSE NULL END AS MY_NUM_OPER_FRACTIONS_CHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN IS NOT NULL AND MY_NUM_OPER_BASETEN IS NOT NULL THEN MY_NUM_OPER_BASETEN - PRE_NUM_OPER_BASETEN ELSE NULL END AS MY_NUM_OPER_BASETEN_CHANGE,
CASE WHEN PRE_OPER_ALG_THINK IS NOT NULL AND MY_OPER_ALG_THINK IS NOT NULL THEN MY_OPER_ALG_THINK - PRE_OPER_ALG_THINK ELSE NULL END AS MY_OPER_ALG_THINK_CHANGE,
CASE WHEN PRE_RATIO_PRO_REL IS NOT NULL AND MY_RATIO_PRO_REL IS NOT NULL THEN MY_RATIO_PRO_REL - PRE_RATIO_PRO_REL ELSE NULL END AS MY_RATIO_PRO_REL_CHANGE,
CASE WHEN PRE_REA_EQU_INEQU IS NOT NULL AND MY_REA_EQU_INEQU IS NOT NULL THEN MY_REA_EQU_INEQU - PRE_REA_EQU_INEQU ELSE NULL END AS MY_REA_EQU_INEQU_CHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP IS NOT NULL AND MY_SEE_STRUCT_EXP IS NOT NULL THEN MY_SEE_STRUCT_EXP - PRE_SEE_STRUCT_EXP ELSE NULL END AS MY_SEE_STRUCT_EXP_CHANGE,
CASE WHEN PRE_STAT_PROB IS NOT NULL AND MY_STAT_PROB IS NOT NULL THEN MY_STAT_PROB - PRE_STAT_PROB ELSE NULL END AS MY_STAT_PROB_CHANGE,
CASE WHEN PRE_NUM_SYS IS NOT NULL AND MY_NUM_SYS IS NOT NULL THEN MY_NUM_SYS - PRE_NUM_SYS ELSE NULL END AS MY_NUM_SYS_CHANGE,
CASE WHEN PRE_ART_POL_RAT_EXP_LVL IS NOT NULL AND MY_ART_POL_RAT_EXP_LVL IS NOT NULL THEN PRE_ART_POL_RAT_EXP_LVL + ' to ' + MY_ART_POL_RAT_EXP_LVL ELSE NULL END AS MY_ART_POL_RAT_EXP_PERFCHANGE,
CASE WHEN PRE_CRE_EQU_LVL IS NOT NULL AND MY_CRE_EQU_LVL IS NOT NULL THEN PRE_CRE_EQU_LVL + ' to ' + MY_CRE_EQU_LVL ELSE NULL END AS MY_CRE_EQU_PERFCHANGE,
CASE WHEN PRE_DEMO_MAS_BAS_FACT_LVL IS NOT NULL AND MY_DEMO_MAS_BAS_FACT_LVL IS NOT NULL THEN PRE_DEMO_MAS_BAS_FACT_LVL + ' to ' + MY_DEMO_MAS_BAS_FACT_LVL ELSE NULL END AS MY_DEMO_MAS_BAS_FACT_PERFCHANGE,
CASE WHEN PRE_EXP_EQU_LVL IS NOT NULL AND MY_EXP_EQU_LVL IS NOT NULL THEN PRE_EXP_EQU_LVL + ' to ' + MY_EXP_EQU_LVL ELSE NULL END AS MY_EXP_EQU_PERFCHANGE,
CASE WHEN PRE_FUNCTIONS_LVL IS NOT NULL AND MY_FUNCTIONS_LVL IS NOT NULL THEN PRE_FUNCTIONS_LVL + ' to ' + MY_FUNCTIONS_LVL ELSE NULL END AS MY_FUNCTIONS_PERFCHANGE,
CASE WHEN PRE_GEOMET_LVL IS NOT NULL AND MY_GEOMET_LVL IS NOT NULL THEN PRE_GEOMET_LVL + ' to ' + MY_GEOMET_LVL ELSE NULL END AS MY_GEOMET_PERFCHANGE,
CASE WHEN PRE_GEOMET_MEASURE_LVL IS NOT NULL AND MY_GEOMET_MEASURE_LVL IS NOT NULL THEN PRE_GEOMET_MEASURE_LVL + ' to ' + MY_GEOMET_MEASURE_LVL ELSE NULL END AS MY_GEOMET_MEASURE_PERFCHANGE,
CASE WHEN PRE_MATH_PRACTICE_LVL IS NOT NULL AND MY_MATH_PRACTICE_LVL IS NOT NULL THEN PRE_MATH_PRACTICE_LVL + ' to ' + MY_MATH_PRACTICE_LVL ELSE NULL END AS MY_MATH_PRACTICE_PERFCHANGE,
CASE WHEN PRE_MEASURE_DATA_LVL IS NOT NULL AND MY_MEASURE_DATA_LVL IS NOT NULL THEN PRE_MEASURE_DATA_LVL + ' to ' + MY_MEASURE_DATA_LVL ELSE NULL END AS MY_MEASURE_DATA_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_FRACTIONS_LVL IS NOT NULL AND MY_NUM_OPER_FRACTIONS_LVL IS NOT NULL THEN PRE_NUM_OPER_FRACTIONS_LVL + ' to ' + MY_NUM_OPER_FRACTIONS_LVL ELSE NULL END AS MY_NUM_OPER_FRACTIONS_PERFCHANGE,
CASE WHEN PRE_NUM_OPER_BASETEN_LVL IS NOT NULL AND MY_NUM_OPER_BASETEN_LVL IS NOT NULL THEN PRE_NUM_OPER_BASETEN_LVL + ' to ' + MY_NUM_OPER_BASETEN_LVL ELSE NULL END AS MY_NUM_OPER_BASETEN_PERFCHANGE,
CASE WHEN PRE_OPER_ALG_THINK_LVL IS NOT NULL AND MY_OPER_ALG_THINK_LVL IS NOT NULL THEN PRE_OPER_ALG_THINK_LVL + ' to ' + MY_OPER_ALG_THINK_LVL ELSE NULL END AS MY_OPER_ALG_THINK_PERFCHANGE,
CASE WHEN PRE_RATIO_PRO_REL_LVL IS NOT NULL AND MY_RATIO_PRO_REL_LVL IS NOT NULL THEN PRE_RATIO_PRO_REL_LVL + ' to ' + MY_RATIO_PRO_REL_LVL ELSE NULL END AS MY_RATIO_PRO_REL_PERFCHANGE,
CASE WHEN PRE_REA_EQU_INEQU_LVL IS NOT NULL AND MY_REA_EQU_INEQU_LVL IS NOT NULL THEN PRE_REA_EQU_INEQU_LVL + ' to ' + MY_REA_EQU_INEQU_LVL ELSE NULL END AS MY_REA_EQU_INEQU_PERFCHANGE,
CASE WHEN PRE_SEE_STRUCT_EXP_LVL IS NOT NULL AND MY_SEE_STRUCT_EXP_LVL IS NOT NULL THEN PRE_SEE_STRUCT_EXP_LVL + ' to ' + MY_SEE_STRUCT_EXP_LVL ELSE NULL END AS MY_SEE_STRUCT_EXP_PERFCHANGE,
CASE WHEN PRE_STAT_PROB_LVL IS NOT NULL AND MY_STAT_PROB_LVL IS NOT NULL THEN PRE_STAT_PROB_LVL + ' to ' + MY_STAT_PROB_LVL ELSE NULL END AS MY_STAT_PROB_PERFCHANGE,
CASE WHEN PRE_NUM_SYS_LVL IS NOT NULL AND MY_NUM_SYS_LVL IS NOT NULL THEN PRE_NUM_SYS_LVL + ' to ' + MY_NUM_SYS_LVL ELSE NULL END AS MY_NUM_SYS_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_MY_MTH_SB_subtable
FROM
(SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_ART_POL_RAT_EXP, prepost.PRE_CRE_EQU, prepost.PRE_DEMO_MAS_BAS_FACT, prepost.PRE_EXP_EQU, prepost.PRE_FUNCTIONS, prepost.PRE_GEOMET, prepost.PRE_GEOMET_MEASURE, prepost.PRE_MATH_PRACTICE, prepost.PRE_MEASURE_DATA, prepost.PRE_NUM_OPER_FRACTIONS, prepost.PRE_NUM_OPER_BASETEN, prepost.PRE_OPER_ALG_THINK, prepost.PRE_RATIO_PRO_REL, prepost.PRE_REA_EQU_INEQU, prepost.PRE_SEE_STRUCT_EXP, prepost.PRE_STAT_PROB, prepost.PRE_NUM_SYS, prepost.POST_INTERVAL, prepost.POST_ART_POL_RAT_EXP, prepost.POST_CRE_EQU, prepost.POST_DEMO_MAS_BAS_FACT, prepost.POST_EXP_EQU, prepost.POST_FUNCTIONS, prepost.POST_GEOMET, prepost.POST_GEOMET_MEASURE, prepost.POST_MATH_PRACTICE, prepost.POST_MEASURE_DATA, prepost.POST_NUM_OPER_FRACTIONS, prepost.POST_NUM_OPER_BASETEN, prepost.POST_OPER_ALG_THINK, prepost.POST_RATIO_PRO_REL, prepost.POST_REA_EQU_INEQU, prepost.POST_SEE_STRUCT_EXP, prepost.POST_STAT_PROB, prepost.POST_NUM_SYS, prepost.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, prepost.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, prepost.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, prepost.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, prepost.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, prepost.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, prepost.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_GRADE_CHANGE_ACTUAL, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, prepost.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, prepost.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, prepost.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, prepost.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_CRE_EQU_GRADE_CHANGE_DEGREE, prepost.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, prepost.SB_EXP_EQU_GRADE_CHANGE_DEGREE, prepost.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_GRADE_CHANGE_DEGREE, prepost.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, prepost.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, prepost.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, prepost.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, prepost.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, prepost.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, prepost.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, prepost.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, prepost.SB_STAT_PROB_GRADE_CHANGE_DEGREE, prepost.SB_NUM_SYS_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_ART_POL_RAT_EXP_LVL, prepost.PRE_CRE_EQU_LVL, prepost.PRE_DEMO_MAS_BAS_FACT_LVL, prepost.PRE_EXP_EQU_LVL, prepost.PRE_FUNCTIONS_LVL, prepost.PRE_GEOMET_LVL, prepost.PRE_GEOMET_MEASURE_LVL, prepost.PRE_MATH_PRACTICE_LVL, prepost.PRE_MEASURE_DATA_LVL, prepost.PRE_NUM_OPER_FRACTIONS_LVL, prepost.PRE_NUM_OPER_BASETEN_LVL, prepost.PRE_OPER_ALG_THINK_LVL, prepost.PRE_RATIO_PRO_REL_LVL, prepost.PRE_REA_EQU_INEQU_LVL, prepost.PRE_SEE_STRUCT_EXP_LVL, prepost.PRE_STAT_PROB_LVL, prepost.PRE_NUM_SYS_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_ART_POL_RAT_EXP_LVL, prepost.POST_CRE_EQU_LVL, prepost.POST_DEMO_MAS_BAS_FACT_LVL, prepost.POST_EXP_EQU_LVL, prepost.POST_FUNCTIONS_LVL, prepost.POST_GEOMET_LVL, prepost.POST_GEOMET_MEASURE_LVL, prepost.POST_MATH_PRACTICE_LVL, prepost.POST_MEASURE_DATA_LVL, prepost.POST_NUM_OPER_FRACTIONS_LVL, prepost.POST_NUM_OPER_BASETEN_LVL, prepost.POST_OPER_ALG_THINK_LVL, prepost.POST_RATIO_PRO_REL_LVL, prepost.POST_REA_EQU_INEQU_LVL, prepost.POST_SEE_STRUCT_EXP_LVL, prepost.POST_STAT_PROB_LVL, prepost.POST_NUM_SYS_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE,
CASE WHEN prepost.TTL_TIME >= ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 1 WHEN prepost.TTL_TIME < ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2 THEN 0 ELSE NULL END AS MY_MET_MARCH_DOSAGE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_INTERVAL ELSE prepost.POST_INTERVAL END AS MY_INTERVAL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_ART_POL_RAT_EXP ELSE prepost.POST_ART_POL_RAT_EXP END AS MY_ART_POL_RAT_EXP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_CRE_EQU ELSE prepost.POST_CRE_EQU END AS MY_CRE_EQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_DEMO_MAS_BAS_FACT ELSE prepost.POST_DEMO_MAS_BAS_FACT END AS MY_DEMO_MAS_BAS_FACT,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_EXP_EQU ELSE prepost.POST_EXP_EQU END AS MY_EXP_EQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_FUNCTIONS ELSE prepost.POST_FUNCTIONS END AS MY_FUNCTIONS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET ELSE prepost.POST_GEOMET END AS MY_GEOMET,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_MEASURE ELSE prepost.POST_GEOMET_MEASURE END AS MY_GEOMET_MEASURE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MATH_PRACTICE ELSE prepost.POST_MATH_PRACTICE END AS MY_MATH_PRACTICE,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MEASURE_DATA ELSE prepost.POST_MEASURE_DATA END AS MY_MEASURE_DATA,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_FRACTIONS ELSE prepost.POST_NUM_OPER_FRACTIONS END AS MY_NUM_OPER_FRACTIONS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_BASETEN ELSE prepost.POST_NUM_OPER_BASETEN END AS MY_NUM_OPER_BASETEN,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_OPER_ALG_THINK ELSE prepost.POST_OPER_ALG_THINK END AS MY_OPER_ALG_THINK,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_RATIO_PRO_REL ELSE prepost.POST_RATIO_PRO_REL END AS MY_RATIO_PRO_REL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_REA_EQU_INEQU ELSE prepost.POST_REA_EQU_INEQU END AS MY_REA_EQU_INEQU,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_SEE_STRUCT_EXP ELSE prepost.POST_SEE_STRUCT_EXP END AS MY_SEE_STRUCT_EXP,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_STAT_PROB ELSE prepost.POST_STAT_PROB END AS MY_STAT_PROB,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_SYS ELSE prepost.POST_NUM_SYS END AS MY_NUM_SYS,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_ART_POL_RAT_EXP_LVL ELSE prepost.POST_ART_POL_RAT_EXP_LVL END AS MY_ART_POL_RAT_EXP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_CRE_EQU_LVL ELSE prepost.POST_CRE_EQU_LVL END AS MY_CRE_EQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_DEMO_MAS_BAS_FACT_LVL ELSE prepost.POST_DEMO_MAS_BAS_FACT_LVL END AS MY_DEMO_MAS_BAS_FACT_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_EXP_EQU_LVL ELSE prepost.POST_EXP_EQU_LVL END AS MY_EXP_EQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_FUNCTIONS_LVL ELSE prepost.POST_FUNCTIONS_LVL END AS MY_FUNCTIONS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_LVL ELSE prepost.POST_GEOMET_LVL END AS MY_GEOMET_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_GEOMET_MEASURE_LVL ELSE prepost.POST_GEOMET_MEASURE_LVL END AS MY_GEOMET_MEASURE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MATH_PRACTICE_LVL ELSE prepost.POST_MATH_PRACTICE_LVL END AS MY_MATH_PRACTICE_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_MEASURE_DATA_LVL ELSE prepost.POST_MEASURE_DATA_LVL END AS MY_MEASURE_DATA_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_FRACTIONS_LVL ELSE prepost.POST_NUM_OPER_FRACTIONS_LVL END AS MY_NUM_OPER_FRACTIONS_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_OPER_BASETEN_LVL ELSE prepost.POST_NUM_OPER_BASETEN_LVL END AS MY_NUM_OPER_BASETEN_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_OPER_ALG_THINK_LVL ELSE prepost.POST_OPER_ALG_THINK_LVL END AS MY_OPER_ALG_THINK_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_RATIO_PRO_REL_LVL ELSE prepost.POST_RATIO_PRO_REL_LVL END AS MY_RATIO_PRO_REL_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_REA_EQU_INEQU_LVL ELSE prepost.POST_REA_EQU_INEQU_LVL END AS MY_REA_EQU_INEQU_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_SEE_STRUCT_EXP_LVL ELSE prepost.POST_SEE_STRUCT_EXP_LVL END AS MY_SEE_STRUCT_EXP_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_STAT_PROB_LVL ELSE prepost.POST_STAT_PROB_LVL END AS MY_STAT_PROB_LVL,
CASE WHEN prepost.POST_INTERVAL IS NULL AND (prepost.PRE_INTERVAL < prepost.PROXY_INTERVAL OR prepost.PRE_INTERVAL LIKE 'Math PrYr/Cumulative') THEN prepost.PROXY_NUM_SYS_LVL ELSE prepost.POST_NUM_SYS_LVL END AS MY_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(SELECT MTH_SB_Orig.STUDENT_ID, MTH_SB_Orig.PRE_INTERVAL, MTH_SB_Orig.PRE_ART_POL_RAT_EXP, MTH_SB_Orig.PRE_CRE_EQU, MTH_SB_Orig.PRE_DEMO_MAS_BAS_FACT, MTH_SB_Orig.PRE_EXP_EQU, MTH_SB_Orig.PRE_FUNCTIONS, MTH_SB_Orig.PRE_GEOMET, MTH_SB_Orig.PRE_GEOMET_MEASURE, MTH_SB_Orig.PRE_MATH_PRACTICE, MTH_SB_Orig.PRE_MEASURE_DATA, MTH_SB_Orig.PRE_NUM_OPER_FRACTIONS, MTH_SB_Orig.PRE_NUM_OPER_BASETEN, MTH_SB_Orig.PRE_OPER_ALG_THINK, MTH_SB_Orig.PRE_RATIO_PRO_REL, MTH_SB_Orig.PRE_REA_EQU_INEQU, MTH_SB_Orig.PRE_SEE_STRUCT_EXP, MTH_SB_Orig.PRE_STAT_PROB, MTH_SB_Orig.PRE_NUM_SYS, MTH_SB_Orig.POST_INTERVAL, MTH_SB_Orig.POST_ART_POL_RAT_EXP, MTH_SB_Orig.POST_CRE_EQU, MTH_SB_Orig.POST_DEMO_MAS_BAS_FACT, MTH_SB_Orig.POST_EXP_EQU, MTH_SB_Orig.POST_FUNCTIONS, MTH_SB_Orig.POST_GEOMET, MTH_SB_Orig.POST_GEOMET_MEASURE, MTH_SB_Orig.POST_MATH_PRACTICE, MTH_SB_Orig.POST_MEASURE_DATA, MTH_SB_Orig.POST_NUM_OPER_FRACTIONS, MTH_SB_Orig.POST_NUM_OPER_BASETEN, MTH_SB_Orig.POST_OPER_ALG_THINK, MTH_SB_Orig.POST_RATIO_PRO_REL, MTH_SB_Orig.POST_REA_EQU_INEQU, MTH_SB_Orig.POST_SEE_STRUCT_EXP, MTH_SB_Orig.POST_STAT_PROB, MTH_SB_Orig.POST_NUM_SYS, MTH_SB_Orig.SB_ART_POL_RAT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_CRE_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_EXP_EQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_FUNCTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_GEOMET_MEASURE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MATH_PRACTICE_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_MEASURE_DATA_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_OPER_ALG_THINK_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_RATIO_PRO_REL_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_REA_EQU_INEQU_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_STAT_PROB_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_NUM_SYS_PERFORMANCE_LEVEL_CHANGE, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_ACTUAL, MTH_SB_Orig.SB_ART_POL_RAT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_CRE_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_DEMO_MAS_BAS_FACT_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_EXP_EQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_FUNCTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_GEOMET_MEASURE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MATH_PRACTICE_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_MEASURE_DATA_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_FRACTIONS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_OPER_BASETEN_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_OPER_ALG_THINK_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_RATIO_PRO_REL_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_REA_EQU_INEQU_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_SEE_STRUCT_EXP_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_STAT_PROB_GRADE_CHANGE_DEGREE, MTH_SB_Orig.SB_NUM_SYS_GRADE_CHANGE_DEGREE, MTH_SB_Orig.CURRENTLY_ENROLLED, MTH_SB_Orig.ENROLLED_DAYS, MTH_SB_Orig.ENROLLED_DAYS_CATEGORIES, MTH_SB_Orig.TTL_TIME, MTH_SB_Orig.DOSAGE_CATEGORIES, MTH_SB_Orig.STATUS_SITE_DOSAGE_GOAL, MTH_SB_Orig.SITE_DOSAGE_GOAL, MTH_SB_Orig.Attendance_IA, MTH_SB_Orig.ELA_IA, MTH_SB_Orig.Math_IA, MTH_SB_Orig.Behavior_IA, MTH_SB_Orig.FISCAL_YEAR, MTH_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, MTH_PRE_LVL.PRE_ART_POL_RAT_EXP_LVL, MTH_PRE_LVL.PRE_CRE_EQU_LVL, MTH_PRE_LVL.PRE_DEMO_MAS_BAS_FACT_LVL, MTH_PRE_LVL.PRE_EXP_EQU_LVL, MTH_PRE_LVL.PRE_FUNCTIONS_LVL, MTH_PRE_LVL.PRE_GEOMET_LVL, MTH_PRE_LVL.PRE_GEOMET_MEASURE_LVL, MTH_PRE_LVL.PRE_MATH_PRACTICE_LVL, MTH_PRE_LVL.PRE_MEASURE_DATA_LVL, MTH_PRE_LVL.PRE_NUM_OPER_FRACTIONS_LVL, MTH_PRE_LVL.PRE_NUM_OPER_BASETEN_LVL, MTH_PRE_LVL.PRE_OPER_ALG_THINK_LVL, MTH_PRE_LVL.PRE_RATIO_PRO_REL_LVL, MTH_PRE_LVL.PRE_REA_EQU_INEQU_LVL, MTH_PRE_LVL.PRE_SEE_STRUCT_EXP_LVL, MTH_PRE_LVL.PRE_STAT_PROB_LVL, MTH_PRE_LVL.PRE_NUM_SYS_LVL, MTH_POST_LVL.POST_FREQUENCY_PERIOD_ID, MTH_POST_LVL.POST_ART_POL_RAT_EXP_LVL, MTH_POST_LVL.POST_CRE_EQU_LVL, MTH_POST_LVL.POST_DEMO_MAS_BAS_FACT_LVL, MTH_POST_LVL.POST_EXP_EQU_LVL, MTH_POST_LVL.POST_FUNCTIONS_LVL, MTH_POST_LVL.POST_GEOMET_LVL, MTH_POST_LVL.POST_GEOMET_MEASURE_LVL, MTH_POST_LVL.POST_MATH_PRACTICE_LVL, MTH_POST_LVL.POST_MEASURE_DATA_LVL, MTH_POST_LVL.POST_NUM_OPER_FRACTIONS_LVL, MTH_POST_LVL.POST_NUM_OPER_BASETEN_LVL, MTH_POST_LVL.POST_OPER_ALG_THINK_LVL, MTH_POST_LVL.POST_RATIO_PRO_REL_LVL, MTH_POST_LVL.POST_REA_EQU_INEQU_LVL, MTH_POST_LVL.POST_SEE_STRUCT_EXP_LVL, MTH_POST_LVL.POST_STAT_PROB_LVL, MTH_POST_LVL.POST_NUM_SYS_LVL, MTH_SB_PROXY.PROXY_INTERVAL, MTH_SB_PROXY.PROXY_FREQUENCY_PERIOD_ID, MTH_SB_PROXY.PROXY_ART_POL_RAT_EXP, MTH_SB_PROXY.PROXY_ART_POL_RAT_EXP_LVL, MTH_SB_PROXY.PROXY_CRE_EQU, MTH_SB_PROXY.PROXY_CRE_EQU_LVL, MTH_SB_PROXY.PROXY_DEMO_MAS_BAS_FACT, MTH_SB_PROXY.PROXY_DEMO_MAS_BAS_FACT_LVL, MTH_SB_PROXY.PROXY_EXP_EQU, MTH_SB_PROXY.PROXY_EXP_EQU_LVL, MTH_SB_PROXY.PROXY_FUNCTIONS, MTH_SB_PROXY.PROXY_FUNCTIONS_LVL, MTH_SB_PROXY.PROXY_GEOMET, MTH_SB_PROXY.PROXY_GEOMET_LVL, MTH_SB_PROXY.PROXY_GEOMET_MEASURE, MTH_SB_PROXY.PROXY_GEOMET_MEASURE_LVL, MTH_SB_PROXY.PROXY_MATH_PRACTICE, MTH_SB_PROXY.PROXY_MATH_PRACTICE_LVL, MTH_SB_PROXY.PROXY_MEASURE_DATA, MTH_SB_PROXY.PROXY_MEASURE_DATA_LVL, MTH_SB_PROXY.PROXY_NUM_OPER_FRACTIONS, MTH_SB_PROXY.PROXY_NUM_OPER_FRACTIONS_LVL, MTH_SB_PROXY.PROXY_NUM_OPER_BASETEN, MTH_SB_PROXY.PROXY_NUM_OPER_BASETEN_LVL, MTH_SB_PROXY.PROXY_OPER_ALG_THINK, MTH_SB_PROXY.PROXY_OPER_ALG_THINK_LVL, MTH_SB_PROXY.PROXY_RATIO_PRO_REL, MTH_SB_PROXY.PROXY_RATIO_PRO_REL_LVL, MTH_SB_PROXY.PROXY_REA_EQU_INEQU, MTH_SB_PROXY.PROXY_REA_EQU_INEQU_LVL, MTH_SB_PROXY.PROXY_SEE_STRUCT_EXP, MTH_SB_PROXY.PROXY_SEE_STRUCT_EXP_LVL, MTH_SB_PROXY.PROXY_STAT_PROB, MTH_SB_PROXY.PROXY_STAT_PROB_LVL, MTH_SB_PROXY.PROXY_NUM_SYS, MTH_SB_PROXY.PROXY_NUM_SYS_LVL
FROM ((ReportCYData.dbo.EVAL_SB_MATH AS MTH_SB_Orig
LEFT OUTER JOIN
(SELECT MTH_SB_PRELVL.STUDENT_ID,
AVG(MTH_SB_PRELVL.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB_PRELVL.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB_PRELVL.SCALE_LOCAL ELSE NULL END) AS PRE_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB_PRELVL
WHERE (MTH_SB_PRELVL.INDICATOR_AREA_ID = 5 AND MTH_SB_PRELVL.Tag LIKE 'PRE' AND MTH_SB_PRELVL.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB_PRELVL.STUDENT_ID, MTH_SB_PRELVL.INTERVAL)
AS MTH_PRE_LVL
ON MTH_SB_Orig.STUDENT_ID = MTH_PRE_LVL.STUDENT_ID)
LEFT OUTER JOIN
(SELECT MTH_SB_POSTLVL.STUDENT_ID,
AVG(MTH_SB_POSTLVL.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_ART_POL_RAT_EXP_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_CRE_EQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_DEMO_MAS_BAS_FACT_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_EXP_EQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_FUNCTIONS_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_GEOMET_MEASURE_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_MATH_PRACTICE_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_MEASURE_DATA_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_FRACTIONS_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_OPER_BASETEN_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_OPER_ALG_THINK_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_RATIO_PRO_REL_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_REA_EQU_INEQU_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_SEE_STRUCT_EXP_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_STAT_PROB_LVL,
MAX(CASE WHEN MTH_SB_POSTLVL.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB_POSTLVL.SCALE_LOCAL ELSE NULL END) AS POST_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB_POSTLVL
WHERE (MTH_SB_POSTLVL.INDICATOR_AREA_ID = 5 AND MTH_SB_POSTLVL.Tag LIKE 'POST' AND MTH_SB_POSTLVL.FISCAL_YEAR LIKE '2014-2015')
GROUP BY MTH_SB_POSTLVL.STUDENT_ID, MTH_SB_POSTLVL.INTERVAL)
AS MTH_POST_LVL
ON MTH_SB_Orig.STUDENT_ID = MTH_POST_LVL.STUDENT_ID)
LEFT OUTER JOIN
(SELECT MTH_SB1.STUDENT_ID, MTH_SB1.INTERVAL AS PROXY_INTERVAL, MTH_SB1.PROXY_FREQUENCY_PERIOD_ID, MTH_SB1.PROXY_ART_POL_RAT_EXP, MTH_SB1.PROXY_ART_POL_RAT_EXP_LVL, MTH_SB1.PROXY_CRE_EQU, MTH_SB1.PROXY_CRE_EQU_LVL, MTH_SB1.PROXY_DEMO_MAS_BAS_FACT, MTH_SB1.PROXY_DEMO_MAS_BAS_FACT_LVL, MTH_SB1.PROXY_EXP_EQU, MTH_SB1.PROXY_EXP_EQU_LVL, MTH_SB1.PROXY_FUNCTIONS, MTH_SB1.PROXY_FUNCTIONS_LVL, MTH_SB1.PROXY_GEOMET, MTH_SB1.PROXY_GEOMET_LVL, MTH_SB1.PROXY_GEOMET_MEASURE, MTH_SB1.PROXY_GEOMET_MEASURE_LVL, MTH_SB1.PROXY_MATH_PRACTICE, MTH_SB1.PROXY_MATH_PRACTICE_LVL, MTH_SB1.PROXY_MEASURE_DATA, MTH_SB1.PROXY_MEASURE_DATA_LVL, MTH_SB1.PROXY_NUM_OPER_FRACTIONS, MTH_SB1.PROXY_NUM_OPER_FRACTIONS_LVL, MTH_SB1.PROXY_NUM_OPER_BASETEN, MTH_SB1.PROXY_NUM_OPER_BASETEN_LVL, MTH_SB1.PROXY_OPER_ALG_THINK, MTH_SB1.PROXY_OPER_ALG_THINK_LVL, MTH_SB1.PROXY_RATIO_PRO_REL, MTH_SB1.PROXY_RATIO_PRO_REL_LVL, MTH_SB1.PROXY_REA_EQU_INEQU, MTH_SB1.PROXY_REA_EQU_INEQU_LVL, MTH_SB1.PROXY_SEE_STRUCT_EXP, MTH_SB1.PROXY_SEE_STRUCT_EXP_LVL, MTH_SB1.PROXY_STAT_PROB, MTH_SB1.PROXY_STAT_PROB_LVL, MTH_SB1.PROXY_NUM_SYS, MTH_SB1.PROXY_NUM_SYS_LVL
FROM
(SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ART_POL_RAT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ART_POL_RAT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CRE_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CRE_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_EXP_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_EXP_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_FUNCTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_FUNCTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET_MEASURE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_MEASURE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MATH_PRACTICE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MATH_PRACTICE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MEASURE_DATA,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MEASURE_DATA_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_BASETEN,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_BASETEN_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_OPER_ALG_THINK,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_OPER_ALG_THINK_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RATIO_PRO_REL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RATIO_PRO_REL_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_REA_EQU_INEQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_REA_EQU_INEQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_SEE_STRUCT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_SEE_STRUCT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_STAT_PROB,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_STAT_PROB_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_SYS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag IS NULL AND MTH_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL)
AS MTH_SB1 LEFT JOIN
(SELECT MTH_SB.STUDENT_ID, MTH_SB.INTERVAL,
AVG(MTH_SB.FREQUENCY_PERIOD_ID) AS PROXY_FREQUENCY_PERIOD_ID,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_ART_POL_RAT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Arithmetic with Polynomials and Rational Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_ART_POL_RAT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_CRE_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Creating Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_CRE_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Demonstrates mastery of basic facts' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_DEMO_MAS_BAS_FACT_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_EXP_EQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Expressions and Equations' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_EXP_EQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_FUNCTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Functions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_FUNCTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_GEOMET_MEASURE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Geometry/Measurement' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_GEOMET_MEASURE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MATH_PRACTICE,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Mathematical Practices' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MATH_PRACTICE_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_MEASURE_DATA,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Measurement and Data' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_MEASURE_DATA_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations - Fractions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_FRACTIONS_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_OPER_BASETEN,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Number and Operations in Base Ten' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_OPER_BASETEN_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_OPER_ALG_THINK,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Operations and Algebraic Thinking' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_OPER_ALG_THINK_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_RATIO_PRO_REL,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Ratio and Proportional Relationships' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_RATIO_PRO_REL_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_REA_EQU_INEQU,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Reasoning with Equations and Inequalities' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_REA_EQU_INEQU_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_SEE_STRUCT_EXP,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Seeing Structure in Expressions' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_SEE_STRUCT_EXP_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_STAT_PROB,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'Statistics and Probability' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_STAT_PROB_LVL,
AVG(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.PERFORMANCE_VALUE_NUMERIC ELSE NULL END) AS PROXY_NUM_SYS,
MAX(CASE WHEN MTH_SB.SKILL_DESCRIPTION LIKE 'The Number System' THEN MTH_SB.SCALE_LOCAL ELSE NULL END) AS PROXY_NUM_SYS_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS MTH_SB
WHERE MTH_SB.INDICATOR_AREA_ID = 5 AND MTH_SB.Tag IS NULL AND MTH_SB.FISCAL_YEAR LIKE '2014-2015'
GROUP BY MTH_SB.STUDENT_ID, MTH_SB.INTERVAL)
AS MTH_SB2
ON MTH_SB1.STUDENT_ID = MTH_SB2.STUDENT_ID AND MTH_SB1.PROXY_FREQUENCY_PERIOD_ID < MTH_SB2.PROXY_FREQUENCY_PERIOD_ID
WHERE MTH_SB2.STUDENT_ID IS NULL)
AS MTH_SB_PROXY
ON MTH_SB_Orig.STUDENT_ID = MTH_SB_PROXY.STUDENT_ID
WHERE MTH_SB_Orig.FISCAL_YEAR LIKE '2014-2015')
AS prepost ON ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID)
ON ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 5 AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015')
AS MTHSBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;