-- These queries set up data for start-of-year student performance data reporting.

-- Step 1.1 and 1.2: Restructure all ELA standards based data (tagged), keeping only scale_local variables. Need one version for pre-tags and one for post-tags.
-- Step 2: First, merge scale_local variables to original table dbo_EVAL_SB_ELA.
-- Step 3: Then, use scale_local variables available for creating new variables at this current step.
-- Step 4: Final calculation of additional variables, based on variables created in Step 3.

-- (Step 1.1) QUERY SYNTAX (Restructure data file - pre-tagged data):

SELECT ELA_SB.STUDENT_ID,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE (ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag LIKE 'PRE' AND ELA_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL;

-- (Step 1.2) QUERY SYNTAX (Restructure data file - post-tagged data):

SELECT ELA_SB.STUDENT_ID,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE (ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag LIKE 'POST' AND ELA_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL;

-- (Step 2) QUERY SYNTAX (Join the scale_local variables with the original table dbo_ELA_SB_ELA):

SELECT ELA_SB_Orig.STUDENT_ID, ELA_SB_Orig.PRE_INTERVAL, ELA_SB_Orig.PRE_CS_INT_WRDS_PRS, ELA_SB_Orig.PRE_CS_ANL_STR_TXTS, ELA_SB_Orig.PRE_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.PRE_ELA_SIM, ELA_SB_Orig.PRE_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.PRE_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.PRE_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.PRE_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.PRE_LANG_VOCABUL, ELA_SB_Orig.PRE_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.POST_INTERVAL, ELA_SB_Orig.POST_CS_INT_WRDS_PRS, ELA_SB_Orig.POST_CS_ANL_STR_TXTS, ELA_SB_Orig.POST_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.POST_ELA_SIM, ELA_SB_Orig.POST_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.POST_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.POST_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.POST_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.POST_LANG_VOCABUL, ELA_SB_Orig.POST_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.CURRENTLY_ENROLLED, ELA_SB_Orig.ENROLLED_DAYS, ELA_SB_Orig.ENROLLED_DAYS_CATEGORIES, ELA_SB_Orig.TTL_TIME, ELA_SB_Orig.DOSAGE_CATEGORIES, ELA_SB_Orig.STATUS_SITE_DOSAGE_GOAL, ELA_SB_Orig.SITE_DOSAGE_GOAL, ELA_SB_Orig.Attendance_IA, ELA_SB_Orig.ELA_IA, ELA_SB_Orig.Math_IA, ELA_SB_Orig.Behavior_IA, ELA_SB_Orig.FISCAL_YEAR, ELA_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, ELA_PRE_LVL.PRE_CS_INT_WRDS_PRS_LVL, ELA_PRE_LVL.PRE_CS_ANL_STR_TXTS_LVL, ELA_PRE_LVL.PRE_CS_ASS_PNT_VW_PUR_LVL, ELA_PRE_LVL.PRE_ELA_SIM_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_EVAL_ARG_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_PRE_LVL.PRE_LANG_VOCABUL_LVL, ELA_PRE_LVL.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_PRE_LVL.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_PRE_LVL.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_POST_LVL.POST_FREQUENCY_PERIOD_ID, ELA_POST_LVL.POST_CS_INT_WRDS_PRS_LVL, ELA_POST_LVL.POST_CS_ANL_STR_TXTS_LVL, ELA_POST_LVL.POST_CS_ASS_PNT_VW_PUR_LVL, ELA_POST_LVL.POST_ELA_SIM_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_EVAL_ARG_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_POST_LVL.POST_LANG_VOCABUL_LVL, ELA_POST_LVL.POST_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_POST_LVL.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_POST_LVL.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM (ReportCYData.dbo.EVAL_SB_ELA AS ELA_SB_Orig
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.1 PRE)*****)
AS ELA_PRE_LVL
ON (ELA_SB_Orig.STUDENT_ID = ELA_PRE_LVL.STUDENT_ID))
LEFT OUTER JOIN
(*****ABOVE_QUERY (1.2 POST)*****)
AS ELA_POST_LVL
ON (ELA_SB_Orig.STUDENT_ID = ELA_POST_LVL.STUDENT_ID)
WHERE ELA_SB_Orig.FISCAL_YEAR LIKE '2014-2015';

-- (Step 3) QUERY SYNTAX (Merge and concatenate -- BASED ON ABOVE QUERIES):

SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_CS_INT_WRDS_PRS, prepost.PRE_CS_ANL_STR_TXTS, prepost.PRE_CS_ASS_PNT_VW_PUR, prepost.PRE_ELA_SIM, prepost.PRE_INT_KNW_IDA_INT_EVA_CON, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PRE_INT_KNW_IDA_EVAL_ARG, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PRE_KEY_IDEA_DET_READ_CLOSE, prepost.PRE_LANG_VOCABUL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.POST_INTERVAL, prepost.POST_CS_INT_WRDS_PRS, prepost.POST_CS_ANL_STR_TXTS, prepost.POST_CS_ASS_PNT_VW_PUR, prepost.POST_ELA_SIM, prepost.POST_INT_KNW_IDA_INT_EVA_CON, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.POST_INT_KNW_IDA_EVAL_ARG, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.POST_KEY_IDEA_DET_READ_CLOSE, prepost.POST_LANG_VOCABUL, prepost.POST_RNGE_READ_LVL_TXT_CMPX, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, prepost.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, prepost.SB_ELA_SIM_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_CS_INT_WRDS_PRS_LVL, prepost.PRE_CS_ANL_STR_TXTS_LVL, prepost.PRE_CS_ASS_PNT_VW_PUR_LVL, prepost.PRE_ELA_SIM_LVL, prepost.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PRE_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PRE_LANG_VOCABUL_LVL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_CS_INT_WRDS_PRS_LVL, prepost.POST_CS_ANL_STR_TXTS_LVL, prepost.POST_CS_ASS_PNT_VW_PUR_LVL, prepost.POST_ELA_SIM_LVL, prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.POST_LANG_VOCABUL_LVL, prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(*****ABOVE QUERY*****)
AS prepost ON (ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID))
ON (ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3)
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015';

-- (Step 4) QUERY SYNTAX (Final calculation of additional variables, based on variables created in Step 4 -- BASED ON ABOVE QUERY):

DROP TABLE ImpactAnalytics.dbo.FY15_SOY_ELA_SB
SELECT ELASBFINAL.*,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND POST_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + POST_CS_INT_WRDS_PRS_LVL ELSE NULL END AS EOY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND POST_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + POST_CS_ANL_STR_TXTS_LVL ELSE NULL END AS EOY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND POST_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + POST_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS EOY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND POST_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + POST_ELA_SIM_LVL ELSE NULL END AS EOY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND POST_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + POST_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS EOY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS EOY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND POST_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + POST_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS EOY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND POST_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + POST_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND POST_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + POST_LANG_VOCABUL_LVL ELSE NULL END AS EOY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND POST_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + POST_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS EOY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS EOY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS EOY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_SOY_ELA_SB
FROM
(*****ABOVE_QUERY*****)
AS ELASBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;

-- QUERY SYNTAX (Merge and concatenate -- SINGLE QUERY VERSION):

DROP TABLE ImpactAnalytics.dbo.FY15_SOY_ELA_SB
SELECT ELASBFINAL.*,
CASE WHEN PRE_CS_INT_WRDS_PRS_LVL IS NOT NULL AND POST_CS_INT_WRDS_PRS_LVL IS NOT NULL THEN PRE_CS_INT_WRDS_PRS_LVL + ' to ' + POST_CS_INT_WRDS_PRS_LVL ELSE NULL END AS EOY_CS_INT_WRDS_PRS_PERFCHANGE,
CASE WHEN PRE_CS_ANL_STR_TXTS_LVL IS NOT NULL AND POST_CS_ANL_STR_TXTS_LVL IS NOT NULL THEN PRE_CS_ANL_STR_TXTS_LVL + ' to ' + POST_CS_ANL_STR_TXTS_LVL ELSE NULL END AS EOY_CS_ANL_STR_TXTS_PERFCHANGE,
CASE WHEN PRE_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL AND POST_CS_ASS_PNT_VW_PUR_LVL IS NOT NULL THEN PRE_CS_ASS_PNT_VW_PUR_LVL + ' to ' + POST_CS_ASS_PNT_VW_PUR_LVL ELSE NULL END AS EOY_CS_ASS_PNT_VW_PUR_PERFCHANGE,
CASE WHEN PRE_ELA_SIM_LVL IS NOT NULL AND POST_ELA_SIM_LVL IS NOT NULL THEN PRE_ELA_SIM_LVL + ' to ' + POST_ELA_SIM_LVL ELSE NULL END AS EOY_ELA_SIM_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL AND POST_INT_KNW_IDA_INT_EVA_CON_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_INT_EVA_CON_LVL + ' to ' + POST_INT_KNW_IDA_INT_EVA_CON_LVL ELSE NULL END AS EOY_INT_KNW_IDA_INT_EVA_CON_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL AND POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL + ' to ' + POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL ELSE NULL END AS EOY_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFCHANGE,
CASE WHEN PRE_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL AND POST_INT_KNW_IDA_EVAL_ARG_LVL IS NOT NULL THEN PRE_INT_KNW_IDA_EVAL_ARG_LVL + ' to ' + POST_INT_KNW_IDA_EVAL_ARG_LVL ELSE NULL END AS EOY_INT_KNW_IDA_EVAL_ARG_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL AND POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL + ' to ' + POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_ANA_DEV_TXT_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL AND POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL + ' to ' + POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFCHANGE,
CASE WHEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL AND POST_KEY_IDEA_DET_READ_CLOSE_LVL IS NOT NULL THEN PRE_KEY_IDEA_DET_READ_CLOSE_LVL + ' to ' + POST_KEY_IDEA_DET_READ_CLOSE_LVL ELSE NULL END AS EOY_KEY_IDEA_DET_READ_CLOSE_PERFCHANGE,
CASE WHEN PRE_LANG_VOCABUL_LVL IS NOT NULL AND POST_LANG_VOCABUL_LVL IS NOT NULL THEN PRE_LANG_VOCABUL_LVL + ' to ' + POST_LANG_VOCABUL_LVL ELSE NULL END AS EOY_LANG_VOCABUL_PERFCHANGE,
CASE WHEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL AND POST_RNGE_READ_LVL_TXT_CMPX_LVL IS NOT NULL THEN PRE_RNGE_READ_LVL_TXT_CMPX_LVL + ' to ' + POST_RNGE_READ_LVL_TXT_CMPX_LVL ELSE NULL END AS EOY_RNGE_READ_LVL_TXT_CMPX_PERFCHANGE,
CASE WHEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL AND POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL IS NOT NULL THEN PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL + ' to ' + POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL ELSE NULL END AS EOY_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERFCHANGE,
CASE WHEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL AND POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL IS NOT NULL THEN PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL + ' to ' + POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL ELSE NULL END AS EOY_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFCHANGE
INTO ImpactAnalytics.dbo.FY15_SOY_ELA_SB
FROM
(SELECT ReportCYData.dbo.RPT_STUDENT_MAIN.SITE_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_NAME, ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.DIPLOMAS_NOW_SCHOOL, ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID, ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID, prepost.PRE_INTERVAL, prepost.PRE_CS_INT_WRDS_PRS, prepost.PRE_CS_ANL_STR_TXTS, prepost.PRE_CS_ASS_PNT_VW_PUR, prepost.PRE_ELA_SIM, prepost.PRE_INT_KNW_IDA_INT_EVA_CON, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.PRE_INT_KNW_IDA_EVAL_ARG, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.PRE_KEY_IDEA_DET_READ_CLOSE, prepost.PRE_LANG_VOCABUL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.POST_INTERVAL, prepost.POST_CS_INT_WRDS_PRS, prepost.POST_CS_ANL_STR_TXTS, prepost.POST_CS_ASS_PNT_VW_PUR, prepost.POST_ELA_SIM, prepost.POST_INT_KNW_IDA_INT_EVA_CON, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, prepost.POST_INT_KNW_IDA_EVAL_ARG, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, prepost.POST_KEY_IDEA_DET_READ_CLOSE, prepost.POST_LANG_VOCABUL, prepost.POST_RNGE_READ_LVL_TXT_CMPX, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, prepost.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, prepost.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, prepost.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, prepost.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, prepost.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, prepost.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, prepost.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, prepost.SB_ELA_SIM_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, prepost.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, prepost.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, prepost.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, prepost.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, prepost.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, prepost.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, prepost.CURRENTLY_ENROLLED, prepost.ENROLLED_DAYS, prepost.ENROLLED_DAYS_CATEGORIES, prepost.TTL_TIME, prepost.DOSAGE_CATEGORIES, prepost.STATUS_SITE_DOSAGE_GOAL, prepost.SITE_DOSAGE_GOAL, prepost.Attendance_IA, prepost.ELA_IA, prepost.Math_IA, prepost.Behavior_IA, prepost.PRE_FREQUENCY_PERIOD_ID, prepost.PRE_CS_INT_WRDS_PRS_LVL, prepost.PRE_CS_ANL_STR_TXTS_LVL, prepost.PRE_CS_ASS_PNT_VW_PUR_LVL, prepost.PRE_ELA_SIM_LVL, prepost.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.PRE_INT_KNW_IDA_EVAL_ARG_LVL, prepost.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.PRE_LANG_VOCABUL_LVL, prepost.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.POST_FREQUENCY_PERIOD_ID, prepost.POST_CS_INT_WRDS_PRS_LVL, prepost.POST_CS_ANL_STR_TXTS_LVL, prepost.POST_CS_ASS_PNT_VW_PUR_LVL, prepost.POST_ELA_SIM_LVL, prepost.POST_INT_KNW_IDA_INT_EVA_CON_LVL, prepost.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, prepost.POST_INT_KNW_IDA_EVAL_ARG_LVL, prepost.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, prepost.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, prepost.POST_KEY_IDEA_DET_READ_CLOSE_LVL, prepost.POST_LANG_VOCABUL_LVL, prepost.POST_RNGE_READ_LVL_TXT_CMPX_LVL, prepost.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, prepost.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, prepost.FISCAL_YEAR, ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL1, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL2, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL3, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL4, ReportCYData.dbo.RPT_SCHOOL_GRADE.B_RULE_VAL5,
CASE WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 21 THEN -1 WHEN ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID = 22 THEN 0 ELSE ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID END AS GRADE_ID_RECODE
FROM ReportCYData.dbo.RPT_SCHOOL_GRADE INNER JOIN (ReportCYData.dbo.RPT_STUDENT_MAIN INNER JOIN
(SELECT ELA_SB_Orig.STUDENT_ID, ELA_SB_Orig.PRE_INTERVAL, ELA_SB_Orig.PRE_CS_INT_WRDS_PRS, ELA_SB_Orig.PRE_CS_ANL_STR_TXTS, ELA_SB_Orig.PRE_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.PRE_ELA_SIM, ELA_SB_Orig.PRE_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.PRE_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.PRE_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.PRE_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.PRE_LANG_VOCABUL, ELA_SB_Orig.PRE_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.POST_INTERVAL, ELA_SB_Orig.POST_CS_INT_WRDS_PRS, ELA_SB_Orig.POST_CS_ANL_STR_TXTS, ELA_SB_Orig.POST_CS_ASS_PNT_VW_PUR, ELA_SB_Orig.POST_ELA_SIM, ELA_SB_Orig.POST_INT_KNW_IDA_INT_EVA_CON, ELA_SB_Orig.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP, ELA_SB_Orig.POST_INT_KNW_IDA_EVAL_ARG, ELA_SB_Orig.POST_KEY_IDEA_DET_ANA_DEV_TXT, ELA_SB_Orig.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME, ELA_SB_Orig.POST_KEY_IDEA_DET_READ_CLOSE, ELA_SB_Orig.POST_LANG_VOCABUL, ELA_SB_Orig.POST_RNGE_READ_LVL_TXT_CMPX, ELA_SB_Orig.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD, ELA_SB_Orig.POST_RD_SUFF_ACCR_FLUEN_SUP_COM, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_ELA_SIM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_LANG_VOCABUL_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_PERF_LEVEL_CHANGE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_PERFORMANCE_LEVEL_CHANGE, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_ACTUAL, ELA_SB_Orig.SB_CS_INT_WRDS_PRS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ANL_STR_TXTS_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_CS_ASS_PNT_VW_PUR_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_ELA_SIM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_INT_EVA_CON_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_ANA_SIM_THEME_TOP_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_INT_KNW_IDA_EVAL_ARG_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_ANA_DEV_TXT_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_DTR_CEN_IDA_THEME_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KEY_IDEA_DET_READ_CLOSE_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_LANG_VOCABUL_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RNGE_READ_LVL_TXT_CMPX_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_GRADE_CHANGE_DEGREE, ELA_SB_Orig.SB_RD_SUFF_ACCR_FLUEN_SUP_COM_GRADE_CHANGE_DEGREE, ELA_SB_Orig.CURRENTLY_ENROLLED, ELA_SB_Orig.ENROLLED_DAYS, ELA_SB_Orig.ENROLLED_DAYS_CATEGORIES, ELA_SB_Orig.TTL_TIME, ELA_SB_Orig.DOSAGE_CATEGORIES, ELA_SB_Orig.STATUS_SITE_DOSAGE_GOAL, ELA_SB_Orig.SITE_DOSAGE_GOAL, ELA_SB_Orig.Attendance_IA, ELA_SB_Orig.ELA_IA, ELA_SB_Orig.Math_IA, ELA_SB_Orig.Behavior_IA, ELA_SB_Orig.FISCAL_YEAR, ELA_PRE_LVL.PRE_FREQUENCY_PERIOD_ID, ELA_PRE_LVL.PRE_CS_INT_WRDS_PRS_LVL, ELA_PRE_LVL.PRE_CS_ANL_STR_TXTS_LVL, ELA_PRE_LVL.PRE_CS_ASS_PNT_VW_PUR_LVL, ELA_PRE_LVL.PRE_ELA_SIM_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_PRE_LVL.PRE_INT_KNW_IDA_EVAL_ARG_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_PRE_LVL.PRE_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_PRE_LVL.PRE_LANG_VOCABUL_LVL, ELA_PRE_LVL.PRE_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_PRE_LVL.PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_PRE_LVL.PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL, ELA_POST_LVL.POST_FREQUENCY_PERIOD_ID, ELA_POST_LVL.POST_CS_INT_WRDS_PRS_LVL, ELA_POST_LVL.POST_CS_ANL_STR_TXTS_LVL, ELA_POST_LVL.POST_CS_ASS_PNT_VW_PUR_LVL, ELA_POST_LVL.POST_ELA_SIM_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_INT_EVA_CON_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL, ELA_POST_LVL.POST_INT_KNW_IDA_EVAL_ARG_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL, ELA_POST_LVL.POST_KEY_IDEA_DET_READ_CLOSE_LVL, ELA_POST_LVL.POST_LANG_VOCABUL_LVL, ELA_POST_LVL.POST_RNGE_READ_LVL_TXT_CMPX_LVL, ELA_POST_LVL.POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL, ELA_POST_LVL.POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM (ReportCYData.dbo.EVAL_SB_ELA AS ELA_SB_Orig
LEFT OUTER JOIN
(SELECT ELA_SB.STUDENT_ID,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS PRE_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS PRE_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE (ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag LIKE 'PRE' AND ELA_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL)
AS ELA_PRE_LVL
ON (ELA_SB_Orig.STUDENT_ID = ELA_PRE_LVL.STUDENT_ID))
LEFT OUTER JOIN
(SELECT ELA_SB.STUDENT_ID,
AVG(ELA_SB.FREQUENCY_PERIOD_ID) AS POST_FREQUENCY_PERIOD_ID,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure:  Interpret words/phrases' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_INT_WRDS_PRS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Analyze structure of texts' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_ANL_STR_TXTS_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Craft and Structure: Assess point of view/purpose' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_CS_ASS_PNT_VW_PUR_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'ELA Simulation' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_ELA_SIM_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas:  Integrate/evaluate content' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_INT_EVA_CON_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Analyze similar themes/topics' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_ANA_SIM_THEME_TOP_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Integration of Knowledge and Ideas: Evaluate the argument' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_INT_KNW_IDA_EVAL_ARG_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Analyze development of text' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_ANA_DEV_TXT_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Determine central ideas/themes' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_DTR_CEN_IDA_THEME_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Key Ideas and Details: Read closely' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KEY_IDEA_DET_READ_CLOSE_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Language: Vocabulary' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_LANG_VOCABUL_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Range of Reading and Level of Text Complexity' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_RNGE_READ_LVL_TXT_CMPX_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Know/apply grade-level phonics/word analysis skills in decoding words' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_KNW_APP_GRD_LVL_PHON_WRD_ANA_SKL_DE_WRD_LVL,
MAX(CASE WHEN ELA_SB.SKILL_DESCRIPTION LIKE 'Read with sufficient accuracy/fluency to support comprehension' THEN ELA_SB.SCALE_LOCAL ELSE NULL END) AS POST_RD_SUFF_ACCR_FLUEN_SUP_COM_LVL
FROM ReportCYData.dbo.RPT_PERFORMANCE_LEVEL_SB AS ELA_SB
WHERE (ELA_SB.INDICATOR_AREA_ID = 3 AND ELA_SB.Tag LIKE 'POST' AND ELA_SB.FISCAL_YEAR LIKE '2014-2015')
GROUP BY ELA_SB.STUDENT_ID, ELA_SB.INTERVAL)
AS ELA_POST_LVL
ON (ELA_SB_Orig.STUDENT_ID = ELA_POST_LVL.STUDENT_ID)
WHERE ELA_SB_Orig.FISCAL_YEAR LIKE '2014-2015')
AS prepost ON (ReportCYData.dbo.RPT_STUDENT_MAIN.STUDENT_ID = prepost.STUDENT_ID))
ON (ReportCYData.dbo.RPT_SCHOOL_GRADE.SCHOOL_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.SCHOOL_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.INDICATOR_ID = 3)
WHERE ReportCYData.dbo.RPT_SCHOOL_GRADE.GRADE_ID = ReportCYData.dbo.RPT_STUDENT_MAIN.GRADE_ID AND ReportCYData.dbo.RPT_SCHOOL_GRADE.FISCAL_YEAR LIKE '2014-2015')
AS ELASBFINAL
ORDER BY SITE_NAME, SCHOOL_NAME, GRADE_ID, STUDENT_ID;